<!DOCTYPE html>
<!-- saved from url=(0065)https://www.codeproject.com/Articles/17031/A-Network-Sniffer-in-C -->
<html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<title>A Network Sniffer in C# - CodeProject</title> 
	<link type="text/css" rel="stylesheet" href="./A Network Sniffer in C# - CodeProject_files/Main.min.css">

	
<meta http-equiv="content-language" content="en-US">

<meta name="Description" content="A simple network sniffer which can parse IP, TCP, UDP, and DNS packets.">
<meta name="Keywords" content="C#, Windows, Visual-Studio, Dev, Intermediate,Internet / Network,General Programming,Free source code, tutorials">
<meta name="Author" content="Hitesh Sharma">
<meta name="Rating" content="General">
<meta name="Revisit-After" content="1 days">
<meta name="application-name" content="CodeProject">
<meta name="google-translate-customization" content="d908bb7ce7aff658-4c2f3a504525c916-g629383f736781a8a-13">

<link rel="dns-prefetch" href="https://ajax.googleapis.com/"> 
<link rel="canonical" href="https://www.codeproject.com/Articles/17031/A-Network-Sniffer-in-C">
<meta name="twitter: card" content="summary">
<meta name="twitter: site" content="@CodeProject">
<meta property="og:url" content="https://www.codeproject.com/Articles/17031/A-Network-Sniffer-in-C">
<meta property="og:title" content="A Network Sniffer in C#">
<meta property="og:description" content="A simple network sniffer which can parse IP, TCP, UDP, and DNS packets.">
<meta property="og:image" content="https://www.codeproject.com/KB/IP/CSNetworkSniffer/Thumb-17031.jpg">

<link rel="alternate" type="application/rss+xml" title="CodeProject Latest articles - All Topics" href="https://www.codeproject.com/WebServices/ArticleRSS.aspx?cat=1">
<link rel="alternate" type="application/rss+xml" title="CodeProject Latest articles - Artificial Intelligence" href="https://www.codeproject.com/WebServices/ArticleRSS.aspx?cat=31">
<link rel="alternate" type="application/rss+xml" title="CodeProject Lounge Postings" href="https://www.codeproject.com/webservices/LoungeRSS.aspx">
<meta name="robots" content="index, follow">
<link rel="search" type="application/opensearchdescription+xml" title="CodeProject" href="https://www.codeproject.com/info/OpenSearch.xml">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link rel="apple-touch-icon" sizes="144x144" href="https://www.codeproject.com/favicon/apple-touch-icon.png"> 
<link rel="icon" type="image/png" sizes="32x32" href="https://www.codeproject.com/favicon/favicon-32x32.png"> 
<link rel="icon" type="image/png" sizes="16x16" href="https://www.codeproject.com/favicon/favicon-16x16.png"> 
<link rel="manifest" href="https://www.codeproject.com/favicon/manifest.json"> 
<link rel="mask-icon" href="https://www.codeproject.com/favicon/safari-pinned-tab.svg" color="#ff9900">
	<script src="./A Network Sniffer in C# - CodeProject_files/pubads_impl_rendering_2019093001.js.download"></script><script async="" type="text/javascript" src="./A Network Sniffer in C# - CodeProject_files/gpt.js.download"></script><script type="application/ld+json">{
  "@context": "http://schema.org",
  "@type": "TechArticle",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://www.codeproject.com/Articles/17031/A-Network-Sniffer-in-C"
   },
  "headline": "A Network Sniffer in C#",
  "url": "https://www.codeproject.com/Articles/17031/A-Network-Sniffer-in-C",
  "discussionUrl": "https://www.codeproject.com/Articles/17031/A-Network-Sniffer-in-C#_comments",
  "isFamilyFriendly": "true",
  "image": "https://www.codeproject.com/KB/IP/CSNetworkSniffer/Thumb-17031.jpg",
  "keywords": "C#,Windows,Visual-Studio,Dev,Intermediate",
  "commentCount": "152",
  "editor" : {
    "@type" : "Person",
    "name" : "Deeksha Shenoy",
    "url" : "https://www.codeproject.com/script/Membership/View.aspx?mid=3866010"
  },
  "license": "http://www.codeproject.com/info/cpol10.aspx",
  "publisher" : {
    "@type" : "Organization",
    "name" : "CodeProject"
  },
  "description": "A simple network sniffer which can parse IP, TCP, UDP, and DNS packets.",
  "articleSection": "Internet / Network",
  "author" : [{
      "@type" : "Person",
      "name" : "Hitesh Sharma",
      "url" : "https://www.codeproject.com/script/Membership/View.aspx?mid=3119405"
    }],
  "datePublished": "2007-01-05",
  "dateCreated": "2007-01-05",
  "dateModified": "2008-02-11"
,
  "aggregateRating" : {
    "@type" : "aggregateRating",
    "ratingValue" : 4.87,
    "ratingCount" : 76,
    "bestRating" : 5,
    "worstRating" : 1
  }
}</script>

<script type="application/ld+json">{
  "@context": "http://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [{
    "@type": "ListItem",
    "position": 1,
    "item" : {
      "@id" : "/Chapters/6/General-Programming.aspx",
      "name" : "General Programming"
    }
  },{
    "@type": "ListItem",
    "position": 2,
    "item" : {
      "@id" : "/KB/IP/",
      "name" : "Internet / Network"
    }
  }]
}</script>


	<!--<base target="_top">--><base href="." target="_top">
	
	




<script type="text/javascript">
	var _gaq = _gaq || [];
	_gaq.push(['_setAccount', 'UA-1735123-1']);
	_gaq.push(['_trackPageview']);
	_gaq.push(['_setDomainName', 'www.codeproject.com']);
	_gaq.push(['_setSessionTimeout', '1200']); 

	(function () {
		var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
		ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
		(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(ga);
	})(); 
</script><script type="text/javascript" async="" src="./A Network Sniffer in C# - CodeProject_files/ga.js.download"></script>



<style type="text/css"></style><link id="avast_os_ext_custom_font" href="chrome-extension://mbckjcfnjmoiinpgddefodcighgikkgn/common/ui/fonts/fonts.css" rel="stylesheet" type="text/css"><link rel="preload" href="./A Network Sniffer in C# - CodeProject_files/f.txt" as="script"><script type="text/javascript" src="./A Network Sniffer in C# - CodeProject_files/f.txt"></script><link rel="preload" href="./A Network Sniffer in C# - CodeProject_files/f(1).txt" as="script"><script type="text/javascript" src="./A Network Sniffer in C# - CodeProject_files/f(1).txt"></script><script src="./A Network Sniffer in C# - CodeProject_files/pubads_impl_2019093001.js.download" async=""></script><link rel="prefetch" href="https://tpc.googlesyndication.com/safeframe/1-0-35/html/container.html"></head>	

<body class="chrome chrome77">

<a class="access-link" href="https://www.codeproject.com/Articles/17031/A-Network-Sniffer-in-C#Main"><img alt="Click here to Skip to main content" src="./A Network Sniffer in C# - CodeProject_files/t.gif"></a>




<div class="page-background">

	
	

	

	
    <div id="ctl00_STM" class="site-top-menu fixed">
        <div class="main-content">
            

<div class="container memberbar clearfix flex-container flex-extend">

	<div id="ctl00_MemberBar_GenInfo" class="flex-item align-left">14,317,509 members</div>

	<div class="flex-item">
		
	</div>

	<div class="flex-item align-right">

		

		

		

			<script type="text/javascript">//<!--
			function doSubmit(secure)
			{
				if (secure)
					document.signinForm.action = "https://www.codeproject.com/script/Membership/LogOn.aspx?rp=%2fArticles%2f17031%2fA-Network-Sniffer-in-C"
				else
					document.signinForm.action = "https://www.codeproject.com/script/Membership/LogOn.aspx?rp=%2fArticles%2f17031%2fA-Network-Sniffer-in-C"
				document.signinForm.submit();
				return true;
			}//-->
			</script>

			<a name="SignUp"></a>
			<span class="member-signin tooltip openable">
				<span><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=%2fArticles%2f17031%2fA-Network-Sniffer-in-C">Sign in</a>
                    <img src="./A Network Sniffer in C# - CodeProject_files/login32.png" width="16px" height="16px" style="vertical-align:middle;">
				</span>

				<div class="tooltip-flyout">
					<form name="signinForm" id="signinForm" action="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=%2fArticles%2f17031%2fA-Network-Sniffer-in-C" method="post" class="tight">

						
						<input id="FormName" name="FormName" value="MenuBarForm" type="hidden">

						<div>Email</div>
						<div><input class="small-text" type="email" name="Email" id="Email"></div>
						<div>Password</div>
						<div><input class="small-text" type="password" name="Password" id="Password"></div>
						<div class="action">
                            <input id="joinBtn" type="button" class="create hidden" onclick="return Join();" value="Join" style="visibility: visible;">
                            <input type="hidden" name="fld_quicksign" value="true">
							<input type="submit" value="Sign in" class="signin" onclick="return doSubmit(false);">
						</div>

						<div class="container">
							
							&nbsp;
							<a id="ctl00_MemberBar_SendPassword" class="forgot float-right" href="https://www.codeproject.com/script/Membership/SendPassword.aspx?rp=/Articles/17031/A-Network-Sniffer-in-C">Forgot your password?</a>
						</div>
					</form>

					<hr class="divider-dark">

					Sign in with <a class="oauth" alt="Sign in using Github" title="Sign in using Github" href="https://www.codeproject.com/script/Membership/OAuthLogOn.aspx?auth=GitHub"><img src="./A Network Sniffer in C# - CodeProject_files/octicons_github.png" style="vertical-align:middle;padding-right:3px;border:0;"></a>
<a class="oauth" alt="Sign in using Linkedin" title="Sign in using Linkedin" href="https://www.codeproject.com/script/Membership/OAuthLogOn.aspx?auth=LinkedIn"><img src="./A Network Sniffer in C# - CodeProject_files/linkedin.png" style="vertical-align:middle;padding-right:3px;border:0;"></a>
<a class="oauth" alt="Sign in using Facebook" title="Sign in using Facebook" href="https://www.codeproject.com/script/Membership/OAuthLogOn.aspx?auth=Facebook"><img src="./A Network Sniffer in C# - CodeProject_files/facebook.png" style="vertical-align:middle;padding-right:3px;border:0;"></a>
<a class="oauth" alt="Sign in using Google" title="Sign in using Google" href="https://www.codeproject.com/script/Membership/OAuthLogOn.aspx?auth=Google"><img src="./A Network Sniffer in C# - CodeProject_files/google-plus.png" style="vertical-align:middle;padding-right:3px;border:0;"></a>
<a class="oauth" alt="Sign in using Microsoft" title="Sign in using Microsoft" href="https://www.codeproject.com/script/Membership/OAuthLogOn.aspx?auth=Microsoft"><img src="./A Network Sniffer in C# - CodeProject_files/microsoft.png" style="vertical-align:middle;padding-right:3px;border:0;"></a>

				</div>
            </span>
		
	</div>
</div>
        </div>
    </div>

	
    <div id="ctl00_SH" class="site-header fixed">
        <div class="main-content">
            <div class="logo"><a href="https://www.codeproject.com/"><img id="ctl00_Logo" tabindex="1" title="CodeProject" src="./A Network Sniffer in C# - CodeProject_files/logo250x135.gif" alt="Home" style="height:135px;width:250px;border-width:0px;"></a></div>
            <div class="promo"><div class="msg-728x90" data-format="728x90" data-type="ad" data-publisher="lqm.codeproject.site" data-zone="General-Programming/Internet-Network/Utilities" data-country="US" data-tags="C#, Windows, Visual-Studio, Dev, Intermediate,rating4.5"><noscript><a href="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/General-Programming/Internet-Network/Utilities&sz=728x90&c=301794"><img src="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/General-Programming/Internet-Network/Utilities&sz=728x90&c=301794"  width="728px" height="90px" target="_blank"/></a></noscript></div></div>
        </div>
    </div>

	
	<div id="ctl00_TPR" class="sub-headerbar clearfix fixed">
    <div class="float-right">
		

<div class="searchbar">

<form method="get" action="https://www.codeproject.com/search.aspx?sbo=kw" name="Search" class="tight">


<table border="0" cellspacing="0" cellpadding="0" class="search"><tbody><tr><td><input tabindex="2" class="search subdue" id="sb_tb" autocomplete="off" value="" name="q"></td><td><input type="image" src="./A Network Sniffer in C# - CodeProject_files/search.gif"></td></tr></tbody></table>

<div class="hover-container">
	<div id="SearchFilter" class="search-advanced small-text align-left" style="display: none;">
	<b>Search within:<br></b>
		
		<input type="radio" id="sb_kw" name="sbo" value="kw" checked="checked"><label for="sb_kw">Articles</label><br>
<input type="radio" id="sb_qa" name="sbo" value="qa"><label for="sb_qa">Quick Answers</label><br>
<input type="radio" id="sb_fm" name="sbo" value="fm"><label for="sb_fm">Messages</label><br>


		
		

		
		
	</div>
</div>
</form>

</div>
    </div>
    <div class="float-left">
		

<div class="navbar clearfix">
<ul class="navmenu openable">

<li class="desktop-only"><a id="ctl00_TopNavBar_Home" href="https://www.codeproject.com/">home</a>


</li><li class="openable"><a id="ctl00_TopNavBar_Art" class="down selected" href="https://www.codeproject.com/script/Articles/Latest.aspx">articles</a>

	<ul>
		<li class="openable"><a id="ctl00_TopNavBar_ArtTopicList" class="fly" onmouseover="navBarMenu.ShowMap(this, &#39;ctl00_TopNavBar_MapFlyout&#39;);" href="https://www.codeproject.com/script/Content/SiteMap.aspx">Chapters and Sections<span class="has-submenu">&gt;</span></a><ul id="ctl00_TopNavBar_MapFlyout" class="taxonomy">
			<li>
				<div id="siteMap"></div>
			</li>
			</ul>
		</li>
		
		<li><a id="ctl00_TopNavBar_ArtLatestArts" class="fly" href="https://www.codeproject.com/script/Articles/Latest.aspx?at=1,3,7">Latest Articles</a></li>
		
		<li><a id="ctl00_TopNavBar_ArtTop" class="fly" href="https://www.codeproject.com/script/Articles/TopArticles.aspx?ta_so=5">Top Articles</a></li>
		
		
		<li><a id="ctl00_TopNavBar_ArtGuide" class="fly" href="https://www.codeproject.com/info/Submit.aspx">Posting/Update Guidelines</a></li>
		<li><a id="ctl00_TopNavBar_ArtHelpForum" class="fly" href="https://www.codeproject.com/Forums/1641/Article-Writing.aspx">Article Help Forum</a></li>
		
		<li><a id="ctl00_TopNavBar_ArtPostArticle" class="fly highlight1" href="https://www.codeproject.com/script/Articles/Submit.aspx">
			<img src="./A Network Sniffer in C# - CodeProject_files/write13.png" width="13" height="13"> Submit an article or tip
			</a></li>
        
		<li><a id="ctl00_TopNavBar_ArtImportGitHub" class="fly highlight3" href="https://www.codeproject.com/script/Articles/ImportArticle.aspx">
			<img src="./A Network Sniffer in C# - CodeProject_files/write13.png" width="13" height="13"> Import GitHub Project
			</a></li>
        
		<li><a id="ctl00_TopNavBar_ArtPostBlog" class="fly highlight2" href="https://www.codeproject.com/script/Articles/BlogFeed.aspx">
			<img src="./A Network Sniffer in C# - CodeProject_files/write13.png" width="13" height="13"> Import your Blog
			</a></li>		
        
        <li class="last"></li>
	</ul>

</li>



<li class="openable">
<a id="ctl00_TopNavBar_Answers" href="https://www.codeproject.com/script/Answers/List.aspx?tab=active">
    <span class="desktop-only tablet-only">quick answers</span><span class="mobile-only">Q&amp;A</span>
</a>
	<ul>
		<li id="ctl00_TopNavBar_AQL"><a id="ctl00_TopNavBar_ArticleQuestion" class="fly highlight1" href="https://www.codeproject.com/Articles/17031/A-Network-Sniffer-in-C#_comments">
			<img src="./A Network Sniffer in C# - CodeProject_files/write13.png" width="13" height="13"> Ask a Question about this 
			article</a>
		</li>

		<li><a id="ctl00_TopNavBar_QAAsk" class="fly highlight2" href="https://www.codeproject.com/Questions/ask.aspx"><img src="./A Network Sniffer in C# - CodeProject_files/write13.png" width="13" height="13"> Ask a Question</a></li>

		<li><a id="ctl00_TopNavBar_QAUnanswered" class="fly" href="https://www.codeproject.com/script/Answers/List.aspx?tab=unanswered">View Unanswered Questions</a></li>
		<li><a id="ctl00_TopNavBar_QALatest" class="fly" href="https://www.codeproject.com/script/Answers/List.aspx?tab=active">View All Questions</a></li>
        
				<li><a id="ctl00_TopNavBar_QATR_ctl00_Tag" class="fly" href="https://www.codeproject.com/script/Answers/List.aspx?tab=active&amp;alltags=true&amp;tags=81" style="padding-left:30px">View C# questions</a></li>
			
				<li><a id="ctl00_TopNavBar_QATR_ctl01_Tag" class="fly" href="https://www.codeproject.com/script/Answers/List.aspx?tab=active&amp;alltags=true&amp;tags=85" style="padding-left:30px">View ASP.NET questions</a></li>
			
				<li><a id="ctl00_TopNavBar_QATR_ctl02_Tag" class="fly" href="https://www.codeproject.com/script/Answers/List.aspx?tab=active&amp;alltags=true&amp;tags=842" style="padding-left:30px">View VB.NET questions</a></li>
			
				<li><a id="ctl00_TopNavBar_QATR_ctl03_Tag" class="fly" href="https://www.codeproject.com/script/Answers/List.aspx?tab=active&amp;alltags=true&amp;tags=93" style="padding-left:30px">View SQL questions</a></li>
			
				<li><a id="ctl00_TopNavBar_QATR_ctl04_Tag" class="fly" href="https://www.codeproject.com/script/Answers/List.aspx?tab=active&amp;alltags=true&amp;tags=87" style="padding-left:30px">View Javascript questions</a></li>
			
    
		<li class="last"></li>
	</ul>

</li>



<li class="openable"><a id="ctl00_TopNavBar_Forums" href="https://www.codeproject.com/script/Forums/List.aspx">
        <span class="desktop-only tablet-only">discussions</span><span class="mobile-only">forums</span>
</a>

	<ul>
		<li><a id="ctl00_TopNavBar_MessageBoardsAll" class="fly" href="https://www.codeproject.com/script/Forums/List.aspx">All Message Boards...</a></li>
		<li class="openable"><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1580997/Application-Lifecycle.aspx">Application Lifecycle<span class="has-submenu">&gt;</span></a>
<ul class="openable"><li><a class="fly" href="https://www.codeproject.com/Forums/1533717/Running-a-Business.aspx">Running a Business</a></li>
<li><a class="fly" href="https://www.codeproject.com/Forums/1533716/Sales-Marketing.aspx">Sales / Marketing</a></li>
<li><a class="fly" href="https://www.codeproject.com/Forums/1651/Collaboration-Beta-Testing.aspx">Collaboration / Beta Testing</a></li>
<li><a class="fly" href="https://www.codeproject.com/Forums/3304/Work-Issues.aspx">Work  Issues</a></li>
</ul></li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/369270/Design-and-Architecture.aspx">Design and Architecture</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/12076/ASP-NET.aspx">ASP.NET</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1580226/JavaScript.aspx">JavaScript</a>
</li>
<li class="openable"><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1647/C-Cplusplus-MFC.aspx">C / C++ / MFC<span class="has-submenu">&gt;</span></a>
<ul class="openable"><li><a class="fly" href="https://www.codeproject.com/Forums/4486/ATL-WTL-STL.aspx">ATL /  WTL / STL</a></li>
<li><a class="fly" href="https://www.codeproject.com/Forums/3785/Managed-Cplusplus-CLI.aspx">Managed C++/CLI</a></li>
</ul></li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1649/Csharp.aspx">C#</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1627782/Free-Tools.aspx">Free Tools</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1827460/Objective-C-and-Swift.aspx">Objective-C and Swift</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1725/Database.aspx">Database</a>
</li>
<li class="openable"><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/186301/Hardware-Devices.aspx">Hardware &amp; Devices<span class="has-submenu">&gt;</span></a>
<ul class="openable"><li><a class="fly" href="https://www.codeproject.com/Forums/1644/System-Admin.aspx">System Admin</a></li>
</ul></li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1606152/Hosting-and-Servers.aspx">Hosting and Servers</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1643/Java.aspx">Java</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1942421/Linux-Programming.aspx">Linux Programming</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1650/NET-Framework.aspx">.NET Framework</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1848626/Android.aspx">Android</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1876716/iOS.aspx">iOS</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/13695/Mobile.aspx">Mobile</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1540733/SharePoint.aspx">SharePoint</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1004257/Silverlight-WPF.aspx">Silverlight / WPF</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1646/Visual-Basic.aspx">Visual Basic</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1640/Web-Development.aspx">Web Development</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/suggestions.aspx">Site Bugs / Suggestions</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1652005/Spam-and-Abuse-Watch.aspx">Spam and Abuse Watch</a>
</li>

		<li class="last"></li>
	</ul>

</li>

<li class="openable"><a id="ctl00_TopNavBar_Features" href="https://www.codeproject.com/Feature/">
      <span class="desktop-only tablet-only">features</span><span class="mobile-only">stuff</span>
</a>

	<ul>
		<li><a id="ctl00_TopNavBar_Comps" class="fly" href="https://www.codeproject.com/script/Contests/CurrentCompetitions.aspx?cmpTpId=3&amp;awsac=true">Competitions</a></li>
		<li><a id="ctl00_TopNavBar_News" class="fly" href="https://www.codeproject.com/script/News/List.aspx">News</a></li>
		<li><a id="ctl00_TopNavBar_Insider" class="fly" href="https://www.codeproject.com/Feature/Insider/">The Insider Newsletter</a></li>
    	<li><a id="ctl00_TopNavBar_DailyBuild" class="fly" href="https://www.codeproject.com/Feature/DailyBuild">The Daily Build Newsletter</a></li>
		<li><a id="ctl00_TopNavBar_Newsletters" class="fly" href="https://www.codeproject.com/script/Mailouts/Archive.aspx?mtpid=1">Newsletter archive</a></li>
		<li><a id="ctl00_TopNavBar_Surveys" class="fly" href="https://www.codeproject.com/script/Surveys/List.aspx">Surveys</a></li>
		<li><a id="ctl00_TopNavBar_Showcase" class="fly" href="https://www.codeproject.com/KB/showcase/">Product Showcase</a></li>
        
		<li><a id="ctl00_TopNavBar_Stuff" class="fly" href="https://www.codeproject.com/Info/Stuff.aspx">CodeProject Stuff</a></li>
		<li class="last"></li>
	</ul>

</li>


<li class="openable"><a id="ctl00_TopNavBar_Lounge" href="https://www.codeproject.com/Lounge.aspx">
            <span class="desktop-only tablet-only">community</span><span class="mobile-only">lounge</span>
</a>

	<ul>
		<li><a id="ctl00_TopNavBar_WhosWho" class="fly" href="https://www.codeproject.com/script/Membership/Profiles.aspx">Who's Who</a></li>
		<li><a id="ctl00_TopNavBar_MVPs" class="fly break" href="https://www.codeproject.com/script/Contests/Winners.aspx?obtid=1&amp;cmpTpId=2&amp;cid=0">Most Valuable Professionals</a></li>
		

		<li><a id="ctl00_TopNavBar_LoungeLnk" class="fly highlight2" href="https://www.codeproject.com/Lounge.aspx">The Lounge &nbsp;</a></li>
		<li><a id="ctl00_TopNavBar_WhereAmILink" class="fly" href="https://www.codeproject.com/Forums/1939564/Where-I-am-Member-Photos.aspx">Where I Am: Member Photos</a></li>
		<li><a id="ctl00_TopNavBar_InsiderLnk" class="fly" href="https://www.codeproject.com/Insider.aspx">The Insider News</a></li>
		<li><a id="ctl00_TopNavBar_WeirdWonderful" class="fly" href="https://www.codeproject.com/Feature/WeirdAndWonderful.aspx">The Weird &amp; The Wonderful</a></li>
		<li></li>
		

		
		<li class="openable"><a class="fly" href="https://www.codeproject.com/Forums/1580229/Hindi.aspx">Non-English Language
			<span class="has-submenu">&gt;</span></a>
		<ul>
		<li><a class="fly" href="https://www.codeproject.com/Forums/1580229/Hindi.aspx">General Indian Topics</a></li>
		
		</ul>
		</li><li class="last"></li>
		
	</ul>

</li>


<li class="openable" style="margin-left:20px"><a id="ctl00_TopNavBar_Help" href="https://www.codeproject.com/KB/FAQs/">
    <span class="desktop-only tablet-only">help</span><span class="mobile-only">?</span>
</a>


	<ul>
		<li><a id="ctl00_TopNavBar_HelpWhatIs" class="fly" href="https://www.codeproject.com/info/guide.aspx">What is 'CodeProject'?</a></li>
		<li><a id="ctl00_TopNavBar_HelpGeneral" class="fly break" href="https://www.codeproject.com/KB/FAQs/">General FAQ</a></li>
		<li><a id="ctl00_TopNavBar_HelpPostQuestion" class="fly break highlight2" href="https://www.codeproject.com/Questions/ask.aspx">Ask a Question</a></li>
		<li><a id="ctl00_TopNavBar_HelpBugs" class="fly" href="https://www.codeproject.com/suggestions.aspx">Bugs and Suggestions</a></li>
		<li><a id="ctl00_TopNavBar_HelpArticles" class="fly" href="https://www.codeproject.com/Forums/1641/Article-Writing.aspx">Article Help Forum</a></li>
		
		
		
		
		<li><a id="ctl00_TopNavBar_HelpAboutUs" class="fly" href="https://www.codeproject.com/info/about.aspx">About Us</a></li>
		<li class="last"></li>
	</ul>

</li>

</ul>

</div>
    </div>
	<div class="sub-headerbar-divider"></div>
	</div>		
	

	<div id="A" class="container-content-wrap fixed"> 

	<div class="container-content">

        
		<div class="clearfix">
			<div class="container-breadcrumb float-left ">
				<div><a href="https://www.codeproject.com/script/Content/SiteMap.aspx">Articles</a> » <a href="https://www.codeproject.com/Chapters/6/General-Programming.aspx">General Programming</a> » <a href="https://www.codeproject.com/KB/IP/">Internet / Network</a> » <a href="https://www.codeproject.com/KB/IP/#Utilities">Utilities</a></div>
			</div>

            <div class="float-left">
				
			</div>

			<div class="edit-links float-right">
				



 
&nbsp;










			</div>

			<div class="article-nav float-right">
                
				


<div style="display:inline-block;position:relative;top:-6px;margin-right:20px">
    
</div>



<span id="ctl00_ActionLinks_BookmarkMd_bookmark" data-type="bookmark" data-ref="2_17031_1" data-size="medium" data-mode="bookmark"><span data-direction="up-right" title="" data-enabletooltip="true" data-tooltip="bookmark this (You&#39;ll need to be logged in first)" class="tooltip"><img src="./A Network Sniffer in C# - CodeProject_files/bookmark48.png" style="width:24px;height:24px;border:none;cursor:pointer;"><div class="speech-bubble-container-up-right" style="width:150px">  <div class="speech-bubble-up-right" style="text-align:center"> bookmark this (You'll need to be logged in first)</div>  <div class="speech-bubble-pointer-up-right">    <div class="speech-bubble-pointer-up-right-inner"></div>  </div></div></span></span> 

<a id="ctl00_ActionLinks_PrintMd" data-tooltip="Print" data-enabletooltip="true" data-width="auto" href="https://www.codeproject.com/Articles/17031/A-Network-Sniffer-in-C?display=Print" class="tooltip" title="">
   <img src="./A Network Sniffer in C# - CodeProject_files/print48.png" width="24px" height="24px" style="border:0">
<div class="speech-bubble-container-up" style="width:auto">  <div class="speech-bubble-up" style="text-align:center"> Print</div>  <div class="speech-bubble-pointer-up">    <div class="speech-bubble-pointer-up-inner"></div>  </div></div></a>



<span id="ctl00_ActionLinks_R">
    
    
</span>
			</div>
		</div>

        
		<div class="extended article-container-parts">

			
			<div id="AT" class="article-container  fixed"> 

				<div class="article">

					<form name="aspnetForm" method="post" action="https://www.codeproject.com/Articles/17031/A-Network-Sniffer-in-C" id="aspnetForm" style="margin:0;padding:0">
<div>
<input type="hidden" name="__VIEWSTATE" id="__VIEWSTATE" value="jle6lKiE0GcZpf1BLn+1iuoDlGctekGSendLUY+h/Tlayjqh60DmAl7tvzHP+IXc8RYLheYr/DKhJJwnuBoYp+yUswlO/FxrW1qBj3xz+5O1aSplOvkKDrL41H2SGDXUBFd+ytykm2CqEq7RIqSUTflElGl1sMFEznkyi2+cRt4ZHdtPu2zZ4Q4Grmch/2buTwlJ9gUPnZJPUNN1Vvd8HBlS5JAr4uCR/5IAb15CRZZLXD0s8CmeL0ctmU0zDvjjVwZhd3U8lbGbDfJSSSQjccTQZ6hi0X35++TAmpQ8hdx1HN1LCYVTFwtldTSObS2z52v8cGjGE8wOO5FjgwyaXz/0clD57FU4nZDX9pmsOX7i+lV4pyw6CPhI5u6TU7UttspVEbkZSNnCuq+NmDwu92YwIyprhtAETNl+R1I6m+qu2PbSqRy8uEiduDK9znpRam9HqqV/7Lf+1Ky4uk+N8YiCUsjBnUuqWPoHMzq9BcAN3i5VtOkuqtR1JidTd/tveKQjxj9xel+/t6gYcmHoLgVRRY5BEB6D3qeFEYAA/ynzq9SCQfIibxOR/Ro2l4k+hp146zoCdCB5J3DNguRtvcE/K24v0AArs2Udv3YCFbXeESxb0XpC0bBh1MJxm8xb1DKZvQ7W4D2/pLnIgjO0cD8c7zT/LYyLHXgFI+2OJ3bIWotdekiMLfkJYKHC5NKISqJ/1YNlNqaSFz4e0RMnZeqPKB8JdRpUHcKl6OKpq3VTJmx2nsUOGpmPGc21fz6fM2Byg2Vpu1mLUJEyfKcCx3d/BZI4UG2xV78JWqY/rEweAcd6jbVhaIHiwQXmtHeFB7CkmC71pT4p85f9oHWLQ8WUxvHmB8A2BapdZW5lJCJpcJI68Hh51Rt9F6Vh7vd+IGi7C4btyiyvfPwtfUMIJfLnImbQa3hErNVooJDUydWADnanM5kQhvcInY8Hri8rAQcuz0rPMKi1+OLLKaWz/ZYa+WMwZMcBZqqago8nHMmSRGk2wFo79oVoa6FIACaNNsCUgz0xp6ccSdMLWb9QSqEwpzfinHkcB2z8VGsLv4SrcmtkTDSdf5P63vIjsUh1Jjx5YwnhlIPOW442Jht1r9Nakm9Jk0DWsC2lq2ivt5yYxkcwJYDwecVYzZuf5DgXHsrZCpjTAbosgGflkUCH6fp25BycZC1TSkKZ7cjUwN+GXfaXJiqnf6uGNZnVD6qpq4q9/AxwmiAKhH4oopE66tz7xcmNr/32suMxo7Q7v/TMRtaICb8AAbSE94wHQOZZCmlxluJPQup+zZxpvPER3dL4x1u4+Fnqg0GV/WFwvsKvYtK/n7lt0gm9XKU/mtZ/IMbDuuGnm/+cXigBWxEeAvfJbXDYA8aLPi4Y3N39swLbcsmgq3UtTJxAl09UE0uno4ICBqHUhAhpJynERHnKhe+Ug8F3dTeBtLEHlL9rm+4PNoPOZ9LB2kcgoRM9UHb61DrIs6/t2STgeyUs8AcGU3y7R9mgNC2Bslh15YVGKM91M0Lq2dh6yw8nlCOgGUMURi57KVYWLtE+/C8IpxtbsfI1IIkWXFD5Hb3WIFEoFsvjLjErWrXjqjBQrBVRgwilZK3tCRRuGjl1mOfPyGGRZjZMnqaAV3wY9D66JiYLWtw3zV4fhKzq/SkyjKGoYajJZWmXvu4JqcVbMq39CNnTgSf1AB9GjuJocTrX3p5z+2VfWdEinxvlzv7W1gtWXvBlkHcBbw==">
</div>

<div>

	<input type="hidden" name="__VIEWSTATEGENERATOR" id="__VIEWSTATEGENERATOR" value="10C1FD69">
</div>

					
					 
					<div class="header">
					    <a name="Main"></a>

					    
					    <a name="_articleTop" id="_articleTop"></a>
					    <div class="title">
					        <h1 id="ctl00_ArticleTitle">A Network Sniffer in C#</h1>
					    </div>

                        <div>
					        
					        <div class="entry flex-container">

                                

                                <div class="flex-item" style="flex:1 1 auto">
                                    <div class="flex-container" style="justify-content:space-between;flex-wrap:wrap-reverse">
                                       <span id="ctl00_Authors" class="author flex-item"><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=3119405" rel="author">Hitesh Sharma</a></span> 

                                        <div class="flex-item" style="margin-top:-7px;height:35px">
                                            <div id="ctl00_RateArticle_RateItemWrapper" class="container-rating small-text" name="RateItem_17031">

	<table width="100%" cellpadding="0" cellspacing="0" class="small-text">
	<tbody><tr>
		<td id="ctl00_RateArticle_VoteResultDiv" class="rating-result align-right">
			<span class="align-right"></span>
			<img class="loading invisible" width="16px" alt="loading..." height="16px" src="./A Network Sniffer in C# - CodeProject_files/loading16.gif"> 
		</td>

	
		<td class="voteTbl" style="white-space:nowrap" align="right">
			<table class="small-text">
			<tbody><tr>
				<td id="ctl00_RateArticle_RateText" class="rating-prompt">
					Rate this:
				</td>

				
				<td id="ctl00_RateArticle_VoteFormDiv" class="nowrap tooltip rating-stars-voter-large" style="padding-top:1px">

                    
					

<meta itemprop="upvoteCount" content="74">


<table id="ctl00_RateArticle_ItemRating_RatingTable" cellpadding="0" cellspacing="0" style="margin:0 1px;" class="hide-on-hover float-left">
	<tbody><tr>
		<td class="nowrap">

        <div style="width:120px;height:28px;position:relative" class="nowrap rating-stars-large"><div style="width:116px;height:24px;" class="clipped align-left float-left"><img src="./A Network Sniffer in C# - CodeProject_files/stars-fill-lg.png"></div><div style="width:4px;height:24px;position:relative" class="clipped"><img src="./A Network Sniffer in C# - CodeProject_files/stars-empty-lg.png" style="position:absolute;top:0;right:0"></div>

		
	</div></td>
		<td id="ctl00_RateArticle_ItemRating_VR" class="nowrap">
		<span id="ctl00_RateArticle_ItemRating_VotesR">4.87  (76 votes)</span>
		
	</td>
	</tr>
</tbody></table>

<span id="ctl00_RateArticle_ItemRating_RatingText"></span>


                    
					<span id="ctl00_RateArticle_RB" class="ajaxHist radio voting show-on-hover" style="display: none;">
						<span id="ctl00_RateArticle_VoteRBL"><input id="ctl00_RateArticle_VoteRBL_0" type="radio" name="ctl00$RateArticle$VoteRBL" value="1" style="display: none;"><input id="ctl00_RateArticle_VoteRBL_1" type="radio" name="ctl00$RateArticle$VoteRBL" value="2" style="display: none;"><input id="ctl00_RateArticle_VoteRBL_2" type="radio" name="ctl00$RateArticle$VoteRBL" value="3" style="display: none;"><input id="ctl00_RateArticle_VoteRBL_3" type="radio" name="ctl00$RateArticle$VoteRBL" value="4" style="display: none;"><input id="ctl00_RateArticle_VoteRBL_4" type="radio" name="ctl00$RateArticle$VoteRBL" value="5" style="display: none;"></span> 
					<div class="rating-star-block"><a href="https://www.codeproject.com/Articles/17031/A-Network-Sniffer-in-C#" rating="1" class="star outline" title="vote 1">vote 1</a><a href="https://www.codeproject.com/Articles/17031/A-Network-Sniffer-in-C#" rating="2" class="star outline" title="vote 2">vote 2</a><a href="https://www.codeproject.com/Articles/17031/A-Network-Sniffer-in-C#" rating="3" class="star outline" title="vote 3">vote 3</a><a href="https://www.codeproject.com/Articles/17031/A-Network-Sniffer-in-C#" rating="4" class="star outline" title="vote 4">vote 4</a><a href="https://www.codeproject.com/Articles/17031/A-Network-Sniffer-in-C#" rating="5" class="star outline" title="vote 5">vote 5</a></div></span>

                    
					

                    
	                

                    
                    <div id="ctl00_RateArticle_RSU" class="speech-bubble-container-down">
		                <div class="speech-bubble-down">
                            Please <a id="ctl00_RateArticle_SignUp" href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=%2fArticles%2f17031%2fA-Network-Sniffer-in-C">Sign up or sign in</a> 
                            to vote.
		                </div>
		                <div class="speech-bubble-pointer-down">
			                <div class="speech-bubble-pointer-down-inner"></div>
		                </div>
	                </div>    

				</td>

				
                <td id="ctl00_RateArticle_VR" class="nowrap show-on-hover tooltip" style="display: none;">

		            <span id="ctl00_RateArticle_VotesR">4.87  (76 votes)</span>

                    
					<div id="ctl00_RateArticle_histPHR" class="speech-bubble-container-up-right" style="width:175px;margin-top:24px;right:-15px;top:6px">
						<div class="speech-bubble-up-right">
							<div id="ctl00_RateArticle_HistogramR">

</div>
							<img id="ctl00_RateArticle_LoadingR" class="align-middle" src="./A Network Sniffer in C# - CodeProject_files/loading24.gif" style="border-width:0px;">
						</div>
						<div class="speech-bubble-pointer-up-right">
							<div class="speech-bubble-pointer-up-right-inner"></div>
						</div>
					</div>
                </td>


				<td style="padding-left:5px">	
					<input type="submit" name="ctl00$RateArticle$SubmitRateBtn" value="Vote!" id="ctl00_RateArticle_SubmitRateBtn" class="button" style="display: none;">
				</td>
			</tr>
			</tbody></table>

			
		</td>
	</tr>
	</tbody></table>

</div>
                                        </div>
                                    </div>

                                    <div class="flex-container">
                                        <span id="ctl00_LastUpdated" class="date flex-item-tight" title="Date last updated">11 Feb 2008</span><a id="ctl00_LicenseLink" title="The Code Project Open License (CPOL)" class="license flex-item-tight" href="http://www.codeproject.com/info/cpol10.aspx">CPOL</a>
                                    </div>
                                </div>
					        </div>

                            

                        </div>

                        <div id="ctl00_description" class="summary">A simple network sniffer which can parse IP, TCP, UDP, and DNS packets.</div><span id="ctl00_thumbnailUrl" class="date" content="https://www.codeproject.com/KB/IP/CSNetworkSniffer/Thumb-17031.jpg"></span>			

                    </div>
                    
					
					

					

					
					
					

						
					

					

						
						<div id="contentdiv" class="text">
						



<ul class="download">
<li><a href="https://www.codeproject.com/KB/IP/CSNetworkSniffer/MJsniffer.zip">Download source files - 21.08 KB</a> </li></ul>
<img height="505" alt="Sample Image - CSNetworkSniffer.jpg" hspace="0" src="./A Network Sniffer in C# - CodeProject_files/MJsniffer.jpg" width="600" border="0" class="lazyautosizes ls-is-cached lazyloaded" data-sizes="auto" data-srcset="/KB/IP/CSNetworkSniffer/MJsniffer-r-400.jpg 400w, /KB/IP/CSNetworkSniffer/MJsniffer.jpg 600w" sizes="600px" srcset="/KB/IP/CSNetworkSniffer/MJsniffer-r-400.jpg 400w, /KB/IP/CSNetworkSniffer/MJsniffer.jpg 600w"> 
<h2>Introduction</h2>

<p>In this article, I will discuss the working of a simple network sniffer which can parse IP, TCP, UDP, and DNS packets.</p>

<h2>Capturing the Packets</h2>

<div class="pre-action-link" id="premain146929" style="width:100%;display:block;"><span id="prehide146929" onclick="processCodeBlocks.togglePre(146929);">Hide</span>  &nbsp; <span id="copycode146929" onclick="return processCodeBlocks.copyCode(146929);">Copy Code</span></div><pre lang="cs" id="pre146929" class="notranslate" style="margin-top: 0px;"><span class="code-comment">//</span><span class="code-comment"> For sniffing the socket to capture the packets </span>
<span class="code-comment">//</span><span class="code-comment"> has to be a raw socket, with the address family</span>
<span class="code-comment">//</span><span class="code-comment"> being of type internetwork, and protocol being IP</span>
mainSocket = newSocket(AddressFamily.InterNetwork, SocketType.Raw,
                       ProtocolType.IP);

<span class="code-comment">//</span><span class="code-comment"> Bind the socket to the selected IP address</span>
mainSocket.Bind(newIPEndPoint(IPAddress.Parse(cmbInterfaces.Text),<span class="code-digit">0</span>));

<span class="code-comment">//</span><span class="code-comment"> Set the socket options</span>
mainSocket.SetSocketOption(SocketOptionLevel.IP,  <span class="code-comment">//</span><span class="code-comment">Applies only to IP packets</span>
                           SocketOptionName.HeaderIncluded, <span class="code-comment">//</span><span class="code-comment">Set the include header</span>
                           <span class="code-keyword">true</span>);                           <span class="code-comment">//</span><span class="code-comment">option to true</span>

<span class="code-keyword">byte</span>[] byTrue = newbyte[<span class="code-digit">4</span>]{<span class="code-digit">1</span>, <span class="code-digit">0</span>, <span class="code-digit">0</span>, <span class="code-digit">0</span>};
<span class="code-keyword">byte</span>[] byOut = newbyte[<span class="code-digit">4</span>];

<span class="code-comment">//</span><span class="code-comment">Socket.IOControl is analogous to the WSAIoctl method of Winsock 2</span>
mainSocket.IOControl(IOControlCode.ReceiveAll,  <span class="code-comment">//</span><span class="code-comment">SIO_RCVALL of Winsock</span>
                     byTrue, byOut);

<span class="code-comment">//</span><span class="code-comment">Start receiving the packets asynchronously</span>
mainSocket.BeginReceive(byteData, <span class="code-digit">0</span>, byteData.Length, SocketFlags.None,
                        newAsyncCallback(OnReceive), <span class="code-keyword">null</span>);</pre>

<p>For capturing the packets, we use a raw socket and bind it to the IP address. After setting the proper options for the socket, we then call the <code>IOControl</code> method on it. Notice that <code>IOControl</code> is analogous to the <code>Winsock2WSAIoctl</code> method. The <code>IOControlCode.ReceiveAll</code> implies that all incoming and outgoing packets on the particular interface be captured.</p>

<p>The second parameter passed to <code>IOControl</code> with <code>IOControlCode.ReceiveAll</code> should be <code>TRUE</code> so an array <code>byTrue</code> is created and passed to it (thanks to Leonid Molochniy for this). Next we start receiving all packets asynchronously.</p>

<h2>Analysing the Packets</h2>

<p>The IP datagram encapsulates the TCP and UDP packets. This further contains the data sent by the application layer protocols such as DNS, HTTP, FTP, SMTP, SIP, etc. Thus a TCP packet is received inside the IP datagram, like this:</p>

<div class="pre-action-link" id="premain62363" style="width:100%;display:block;"><span id="prehide62363" onclick="processCodeBlocks.togglePre(62363);">Hide</span>  &nbsp; <span id="copycode62363" onclick="return processCodeBlocks.copyCode(62363);">Copy Code</span></div><pre lang="text" id="pre62363" class="notranslate" style="margin-top: 0px;">+-----------+------------+--------------------+
| IP header | TCP header |        Data        |  
+-----------+------------+--------------------+</pre>

<p>So the first thing that we need to do is to parse the IP header. The stripped version of the IP header class is shown below, the comments describe the things as they happen.</p>

<div class="pre-action-link" id="premain94140" style="width:100%;display:block;"><span id="prehide94140" onclick="processCodeBlocks.togglePre(94140);">Hide</span>  &nbsp; <span id="preShrink94140" onclick="processCodeBlocks.shrinkExpand(94140);">Shrink</span> <img id="preimg94140" src="./A Network Sniffer in C# - CodeProject_files/arrow-up-16.png" style="height:16px;width:16px" onclick="processCodeBlocks.shrinkExpand(94140);">  &nbsp; <span id="copycode94140" onclick="return processCodeBlocks.copyCode(94140);">Copy Code</span></div><pre lang="cs" id="pre94140" processed="true" class="notranslate" style="margin-top: 0px;"><span class="code-keyword">public</span> classIPHeader 
{ 
  <span class="code-comment">//</span><span class="code-comment">IP Header fields </span>
  <span class="code-keyword">private</span> <span class="code-keyword">byte</span> byVersionAndHeaderLength; <span class="code-comment">//</span><span class="code-comment"> Eight bits for version and header </span>
                                         <span class="code-comment">//</span><span class="code-comment"> length </span>
  <span class="code-keyword">private</span> <span class="code-keyword">byte</span> byDifferentiatedServices; <span class="code-comment">//</span><span class="code-comment"> Eight bits for differentiated </span>
                                         <span class="code-comment">//</span><span class="code-comment"> services</span>
  <span class="code-keyword">private</span> <span class="code-keyword">ushort</span> usTotalLength;          <span class="code-comment">//</span><span class="code-comment"> Sixteen bits for total length </span>
  <span class="code-keyword">private</span> <span class="code-keyword">ushort</span> usIdentification;       <span class="code-comment">//</span><span class="code-comment"> Sixteen bits for identification</span>
  <span class="code-keyword">private</span> <span class="code-keyword">ushort</span> usFlagsAndOffset;       <span class="code-comment">//</span><span class="code-comment"> Eight bits for flags and frag. </span>
                                         <span class="code-comment">//</span><span class="code-comment"> offset </span>
  <span class="code-keyword">private</span> <span class="code-keyword">byte</span> byTTL;                    <span class="code-comment">//</span><span class="code-comment"> Eight bits for TTL (Time To Live) </span>
  <span class="code-keyword">private</span> <span class="code-keyword">byte</span> byProtocol;               <span class="code-comment">//</span><span class="code-comment"> Eight bits for the underlying </span>
                                         <span class="code-comment">//</span><span class="code-comment"> protocol </span>
  <span class="code-keyword">private</span> <span class="code-keyword">short</span> sChecksum;               <span class="code-comment">//</span><span class="code-comment"> Sixteen bits for checksum of the </span>
                                         <span class="code-comment">//</span><span class="code-comment">  header </span>
  <span class="code-keyword">private</span> <span class="code-keyword">uint</span> uiSourceIPAddress;        <span class="code-comment">//</span><span class="code-comment"> Thirty two bit source IP Address </span>
  <span class="code-keyword">private</span> <span class="code-keyword">uint</span> uiDestinationIPAddress;   <span class="code-comment">//</span><span class="code-comment"> Thirty two bit destination IP Address </span>

  <span class="code-comment">//</span><span class="code-comment">End IP Header fields   </span>
  <span class="code-keyword">private</span> <span class="code-keyword">byte</span> byHeaderLength;             <span class="code-comment">//</span><span class="code-comment">Header length </span>
  <span class="code-keyword">private</span> <span class="code-keyword">byte</span>[] byIPData = <span class="code-keyword">new</span> <span class="code-keyword">byte</span>[<span class="code-digit">4096</span>]; <span class="code-comment">//</span><span class="code-comment">Data carried by the datagram</span>
  <span class="code-keyword">public</span> IPHeader(<span class="code-keyword">byte</span>[] byBuffer, <span class="code-keyword">int</span> nReceived)
  {
    <span class="code-keyword">try</span>
    {
    <span class="code-comment">//</span><span class="code-comment">Create MemoryStream out of the received bytes</span>
    MemoryStream memoryStream = newMemoryStream(byBuffer, <span class="code-digit">0</span>, nReceived);
    
    <span class="code-comment">//</span><span class="code-comment">Next we create a BinaryReader out of the MemoryStream</span>
    BinaryReader binaryReader = newBinaryReader(memoryStream);

    <span class="code-comment">//</span><span class="code-comment">The first eight bits of the IP header contain the version and</span>
    <span class="code-comment">//</span><span class="code-comment">header length so we read them</span>
    byVersionAndHeaderLength = binaryReader.ReadByte();

    <span class="code-comment">//</span><span class="code-comment">The next eight bits contain the Differentiated services</span>
    byDifferentiatedServices = binaryReader.ReadByte();
    
    <span class="code-comment">//</span><span class="code-comment">Next eight bits hold the total length of the datagram</span>
    usTotalLength = 
             (<span class="code-keyword">ushort</span>) IPAddress.NetworkToHostOrder(binaryReader.ReadInt16());

    <span class="code-comment">//</span><span class="code-comment">Next sixteen have the identification bytes</span>
    usIdentification = 
              (<span class="code-keyword">ushort</span>)IPAddress.NetworkToHostOrder(binaryReader.ReadInt16());

    <span class="code-comment">//</span><span class="code-comment">Next sixteen bits contain the flags and fragmentation offset</span>
    usFlagsAndOffset = 
              (<span class="code-keyword">ushort</span>)IPAddress.NetworkToHostOrder(binaryReader.ReadInt16());

    <span class="code-comment">//</span><span class="code-comment">Next eight bits have the TTL value</span>
    byTTL = binaryReader.ReadByte();

    <span class="code-comment">//</span><span class="code-comment">Next eight represent the protocol encapsulated in the datagram</span>
    byProtocol = binaryReader.ReadByte();

    <span class="code-comment">//</span><span class="code-comment">Next sixteen bits contain the checksum of the header</span>
    sChecksum = IPAddress.NetworkToHostOrder(binaryReader.ReadInt16());

    <span class="code-comment">//</span><span class="code-comment">Next thirty two bits have the source IP address</span>
    uiSourceIPAddress = (<span class="code-keyword">uint</span>)(binaryReader.ReadInt32());

    <span class="code-comment">//</span><span class="code-comment">Next thirty two hold the destination IP address</span>
    uiDestinationIPAddress = (<span class="code-keyword">uint</span>)(binaryReader.ReadInt32());

    <span class="code-comment">//</span><span class="code-comment">Now we calculate the header length</span>
    byHeaderLength = byVersionAndHeaderLength;

    <span class="code-comment">//</span><span class="code-comment">The last four bits of the version and header length field contain the</span>
    <span class="code-comment">//</span><span class="code-comment">header length, we perform some simple binary arithmetic operations to</span>
    <span class="code-comment">//</span><span class="code-comment">extract them</span>
    byHeaderLength &lt;&lt;= <span class="code-digit">4</span>;
    byHeaderLength &gt;&gt;= <span class="code-digit">4</span>;

    <span class="code-comment">//</span><span class="code-comment">Multiply by four to get the exact header length</span>
    byHeaderLength *= <span class="code-digit">4</span>;

    <span class="code-comment">//</span><span class="code-comment">Copy the data carried by the datagram into another array so that</span>
    <span class="code-comment">//</span><span class="code-comment">according to the protocol being carried in the IP datagram</span>
    Array.Copy(byBuffer, 
               byHeaderLength, <span class="code-comment">//</span><span class="code-comment">start copying from the end of the header</span>
               byIPData, <span class="code-digit">0</span>, usTotalLength - byHeaderLength);
    }
    <span class="code-keyword">catch</span> (Exception ex)
    {
        MessageBox.Show(ex.Message, <span class="code-string">"</span><span class="code-string">MJsniff"</span>, MessageBoxButtons.OK, 
                        MessageBoxIcon.Error);
    }
 }
<span class="code-comment">//</span><span class="code-comment">Please see the attached codes for the properties…</span>
}</pre>

<p>Firstly, the class contains the data members corresponding to the fields of the IP header. Kindly see RFC 791 for a detailed explanation of the IP header and its fields. The constructor of the class takes the bytes received and creates a <code>MemoryStream</code> on the received bytes and then creates a <code>BinaryReader</code> to read the data from the <code>MemoryStream</code> byte-by-byte. Also note that the data received from the network is in big-endian form so we use the <code>IPAddress.NetworkToHostOrder </code>to correct the byte ordering. This has to be done for all non-byte data members.</p>

<p>The TCP, UDP headers are also parsed in an identical fashion, the only difference is that they are read from the point where the IP header ends. As an example of parsing the application layer protocols, the attached project can detect DNS packets as well.</p>

<h2>References</h2>

<ul>
<li><a href="http://www.c-sharpcorner.com/Network/SimpleSnifferInCSLM.asp">Simple Sniffer in C#</a> </li></ul>

<h2>Updates</h2>

<ul>
<li>9th February, 2008: Fixed the code to capture both incoming and outgoing packets. Thanks to Darren_vms for pointing this in the comments.</li></ul>


						</div>
						

						<div class="float-right" style="margin:20px 0 0 10px;border:1px solid #ccc">
						<div class="msg-300x250" data-format="300x250" data-type="ad" data-publisher="lqm.codeproject.site" data-zone="General-Programming/Internet-Network/Utilities" data-country="US" data-loadonview="true" data-tags="C#, Windows, Visual-Studio, Dev, Intermediate,rating4.5"><noscript><a href="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/General-Programming/Internet-Network/Utilities&sz=300x250&c=458212"><img src="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/General-Programming/Internet-Network/Utilities&sz=300x250&c=458212"  width="300px" height="250px" target="_blank"/></a></noscript></div>
						</div>
                        
                        
						
						<h2>License</h2>
						<div id="LicenseTerms"><p>This article, along with any associated source code and files, is licensed under <a href="http://www.codeproject.com/info/cpol10.aspx" rel="license">The Code Project Open License (CPOL)</a></p></div>
						<h2>Share</h2>
				        <div class="share-list">
					        

    <ul class="rrssb-buttons clearfix rrssb-1">
        <li id="ctl00_SocialLike_Email" class="email compact">
            <a href="mailto:?subject=A%20Network%20Sniffer%20in%20C%23%20-%20CodeProject&amp;body=Here%27s%20an%20interesting%20article%20on%20for%20you%20on%20codeproject.com%0a%0ahttps%3a%2f%2fwww.codeproject.com%2fArticles%2f17031%2fA-Network-Sniffer-in-C%0a">
                <span class="icon">
                    <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" x="0px" y="0px" width="28px" height="28px" viewBox="0 0 28 28" enable-background="new 0 0 28 28" xml:space="preserve">
                        <g>
                            <path d="M20.111 26.147c-2.336 1.051-4.361 1.401-7.125 1.401c-6.462 0-12.146-4.633-12.146-12.265 
                                c0-7.94 5.762-14.833 14.561-14.833c6.853 0 11.8 4.7 11.8 11.252c0 5.684-3.194 9.265-7.399 
                                9.3 c-1.829 0-3.153-0.934-3.347-2.997h-0.077c-1.208 1.986-2.96 2.997-5.023 2.997c-2.532 
                                0-4.361-1.868-4.361-5.062 c0-4.749 3.504-9.071 9.111-9.071c1.713 0 3.7 0.4 4.6 0.973l-1.169 
                                7.203c-0.388 2.298-0.116 3.3 1 3.4 c1.673 0 3.773-2.102 3.773-6.58c0-5.061-3.27-8.994-9.303-8.994c-5.957 
                                0-11.175 4.673-11.175 12.1 c0 6.5 4.2 10.2 10 10.201c1.986 0 4.089-0.43 5.646-1.245L20.111 
                                26.147z M16.646 10.1 c-0.311-0.078-0.701-0.155-1.207-0.155c-2.571 0-4.595 2.53-4.595 5.529c0 
                                1.5 0.7 2.4 1.9 2.4 c1.441 0 2.959-1.828 3.311-4.087L16.646 10.068z"></path>
                        </g>
                    </svg>
                </span>
                
            </a>
        </li><li id="ctl00_SocialLike_Twitter" class="twitter compact">
            <a href="http://twitter.com/home?status=A+Network+Sniffer+in+C%23+-+CodeProject+-+https%3a%2f%2fwww.codeproject.com%2fArticles%2f17031%2fA-Network-Sniffer-in-C" class="popup">
                <span class="icon">
                    <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="28px" height="28px" viewBox="0 0 28 28" enable-background="new 0 0 28 28" xml:space="preserve">
                    <path d="M24.253,8.756C24.689,17.08,18.297,24.182,9.97,24.62c-3.122,0.162-6.219-0.646-8.861-2.32
                        c2.703,0.179,5.376-0.648,7.508-2.321c-2.072-0.247-3.818-1.661-4.489-3.638c0.801,0.128,1.62,0.076,2.399-0.155
                        C4.045,15.72,2.215,13.6,2.115,11.077c0.688,0.275,1.426,0.407,2.168,0.386c-2.135-1.65-2.729-4.621-1.394-6.965
                        C5.575,7.816,9.54,9.84,13.803,10.071c-0.842-2.739,0.694-5.64,3.434-6.482c2.018-0.623,4.212,0.044,5.546,1.683
                        c1.186-0.213,2.318-0.662,3.329-1.317c-0.385,1.256-1.247,2.312-2.399,2.942c1.048-0.106,2.069-0.394,3.019-0.851
                        C26.275,7.229,25.39,8.196,24.253,8.756z"></path>
                    </svg>
                </span>
                
            </a>
        </li><li id="ctl00_SocialLike_Facebook" class="facebook compact">
            
            <a href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fwww.codeproject.com%2fArticles%2f17031%2fA-Network-Sniffer-in-C" class="popup">
                <span class="icon">
                    <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="28px" height="28px" viewBox="0 0 28 28" enable-background="new 0 0 28 28" xml:space="preserve">
                        <path d="M27.825,4.783c0-2.427-2.182-4.608-4.608-4.608H4.783c-2.422,0-4.608,2.182-4.608,4.608v18.434
                            c0,2.427,2.181,4.608,4.608,4.608H14V17.379h-3.379v-4.608H14v-1.795c0-3.089,2.335-5.885,5.192-5.885h3.718v4.608h-3.726
                            c-0.408,0-0.884,0.492-0.884,1.236v1.836h4.609v4.608h-4.609v10.446h4.916c2.422,0,4.608-2.188,4.608-4.608V4.783z"></path>
                    </svg>
                </span>
                
            </a>
        </li><li id="ctl00_SocialLike_LinkedIn" class="linkedin compact">
            <a href="http://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fwww.codeproject.com%2fArticles%2f17031%2fA-Network-Sniffer-in-C&amp;title=A+Network+Sniffer+in+C%23+-+CodeProject&amp;summary=&amp;source=codeproject.com" class="popup">
                <span class="icon">
                    <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="28px" height="28px" viewBox="0 0 28 28" enable-background="new 0 0 28 28" xml:space="preserve">
                        <path d="M25.424,15.887v8.447h-4.896v-7.882c0-1.979-0.709-3.331-2.48-3.331c-1.354,0-2.158,0.911-2.514,1.803
                            c-0.129,0.315-0.162,0.753-0.162,1.194v8.216h-4.899c0,0,0.066-13.349,0-14.731h4.899v2.088c-0.01,0.016-0.023,0.032-0.033,0.048
                            h0.033V11.69c0.65-1.002,1.812-2.435,4.414-2.435C23.008,9.254,25.424,11.361,25.424,15.887z M5.348,2.501
                            c-1.676,0-2.772,1.092-2.772,2.539c0,1.421,1.066,2.538,2.717,2.546h0.032c1.709,0,2.771-1.132,2.771-2.546
                            C8.054,3.593,7.019,2.501,5.343,2.501H5.348z M2.867,24.334h4.897V9.603H2.867V24.334z"></path>
                    </svg>
                </span>
                
            </a>
        </li><li id="ctl00_SocialLike_Reddit" class="reddit compact">
            <a href="http://www.reddit.com/submit?url=https%3a%2f%2fwww.codeproject.com%2fArticles%2f17031%2fA-Network-Sniffer-in-C&amp;title=A+Network+Sniffer+in+C%23+-+CodeProject">
                <span class="icon">
                    <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" x="0px" y="0px" width="28px" height="28px" viewBox="0 0 28 28" enable-background="new 0 0 28 28" xml:space="preserve"><g>
                    <path d="M11.794 15.316c0-1.029-0.835-1.895-1.866-1.895c-1.03 0-1.893 0.865-1.893 1.895s0.863 1.9 1.9 1.9 C10.958 17.2 11.8 16.3 11.8 15.316z"></path>
                    <path d="M18.1 13.422c-1.029 0-1.895 0.864-1.895 1.895c0 1 0.9 1.9 1.9 1.865c1.031 0 1.869-0.836 1.869-1.865 C19.969 14.3 19.1 13.4 18.1 13.422z"></path>
                    <path d="M17.527 19.791c-0.678 0.678-1.826 1.006-3.514 1.006c-0.004 0-0.009 0-0.014 0c-0.004 0-0.01 0-0.015 0 
                    c-1.686 0-2.834-0.328-3.51-1.005c-0.264-0.265-0.693-0.265-0.958 0c-0.264 0.265-0.264 0.7 0 1 c0.943 0.9 2.4 1.4 
                    4.5 1.402c0.005 0 0 0 0 0c0.005 0 0 0 0 0c2.066 0 3.527-0.459 4.47-1.402 c0.265-0.264 0.265-0.693 0.002-0.958C18.221 
                    19.5 17.8 19.5 17.5 19.791z"></path><path d="M27.707 13.267c0-1.785-1.453-3.237-3.236-3.237c-0.793 0-1.518 0.287-2.082 
                    0.761c-2.039-1.295-4.646-2.069-7.438-2.219 l1.483-4.691l4.062 0.956c0.071 1.4 1.3 2.6 2.7 2.555c1.488 0 2.695-1.208 
                    2.695-2.695C25.881 3.2 24.7 2 23.2 2 c-1.059 0-1.979 0.616-2.42 1.508l-4.633-1.091c-0.344-0.081-0.693 0.118-0.803 
                    0.455l-1.793 5.7 C10.548 8.6 7.7 9.4 5.6 10.75C5.006 10.3 4.3 10 3.5 10.029c-1.785 0-3.237 1.452-3.237 3.2 c0 1.1 0.6 
                    2.1 1.4 2.69c-0.04 0.272-0.061 0.551-0.061 0.831c0 2.3 1.3 4.4 3.7 5.9 c2.299 1.5 5.3 2.3 8.6 2.325c3.228 0 6.271-0.825 
                    8.571-2.325c2.387-1.56 3.7-3.66 3.7-5.917 c0-0.26-0.016-0.514-0.051-0.768C27.088 15.5 27.7 14.4 27.7 13.267z M23.186 
                    3.355c0.74 0 1.3 0.6 1.3 1.3 c0 0.738-0.6 1.34-1.34 1.34s-1.342-0.602-1.342-1.34C21.844 4 22.4 3.4 23.2 3.355z M1.648 
                    13.3 c0-1.038 0.844-1.882 1.882-1.882c0.31 0 0.6 0.1 0.9 0.209c-1.049 0.868-1.813 1.861-2.26 2.9 C1.832 14.2 1.6 13.8 1.6 
                    13.267z M21.773 21.57c-2.082 1.357-4.863 2.105-7.831 2.105c-2.967 0-5.747-0.748-7.828-2.105 
                    c-1.991-1.301-3.088-3-3.088-4.782c0-1.784 1.097-3.484 3.088-4.784c2.081-1.358 4.861-2.106 7.828-2.106 c2.967 0 5.7 
                    0.7 7.8 2.106c1.99 1.3 3.1 3 3.1 4.784C24.859 18.6 23.8 20.3 21.8 21.57z M25.787 14.6 
                    c-0.432-1.084-1.191-2.095-2.244-2.977c0.273-0.156 0.59-0.245 0.928-0.245c1.035 0 1.9 0.8 1.9 1.9 
                    C26.354 13.8 26.1 14.3 25.8 14.605z"></path></g></svg>
                </span>
                
            </a>
        </li><li id="ctl00_SocialLike_Pinterest" class="pinterest compact">
            <a href="http://pinterest.com/pin/create/bookmarklet/?is_video=false&amp;url=https%3a%2f%2fwww.codeproject.com%2fArticles%2f17031%2fA-Network-Sniffer-in-C&amp;description=A+Network+Sniffer+in+C%23+-+CodeProject">
                <span class="icon">
                    <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="28px" height="28px" viewBox="0 0 28 28" enable-background="new 0 0 28 28" xml:space="preserve">
                    <path d="M14.021,1.57C6.96,1.57,1.236,7.293,1.236,14.355c0,7.062,5.724,12.785,12.785,12.785c7.061,0,12.785-5.725,12.785-12.785
                        C26.807,7.294,21.082,1.57,14.021,1.57z M15.261,18.655c-1.161-0.09-1.649-0.666-2.559-1.219c-0.501,2.626-1.113,5.145-2.925,6.458
                        c-0.559-3.971,0.822-6.951,1.462-10.116c-1.093-1.84,0.132-5.545,2.438-4.632c2.837,1.123-2.458,6.842,1.099,7.557
                        c3.711,0.744,5.227-6.439,2.925-8.775c-3.325-3.374-9.678-0.077-8.897,4.754c0.19,1.178,1.408,1.538,0.489,3.168
                        C7.165,15.378,6.53,13.7,6.611,11.462c0.131-3.662,3.291-6.227,6.46-6.582c4.007-0.448,7.771,1.474,8.29,5.239
                        c0.579,4.255-1.816,8.865-6.102,8.533L15.261,18.655z"></path>
                    </svg>
                </span>
                
            </a>
        </li>

    </ul>



				        </div> 
    			        
                        <h2 id="ctl00_AboutHeading">About the Author</h2>
						    

<div class="author-wrapper">

    <div class="pic-wrapper"> 
        <img id="ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberPhoto" class="profile-pic" src="./A Network Sniffer in C# - CodeProject_files/member_unknown.gif" style="border-width:0px;transform:rotate(2deg);">
    </div>

    <div class="container-member">  
        <b><a id="ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberProfileLink" class="author" href="https://www.codeproject.com/Members/User-3116930">Hitesh Sharma</a></b>

        <table>
        <tbody><tr>
            <td rowspan="2" nowrap="" valign="middle">
            
            </td>
            <td nowrap="nowrap">
                <div class="company">
                    <span id="ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberJobTitle"></span>
	                <span id="ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberCompany"></span>
                </div>
            </td>
            <td rowspan="2" style="padding-left:15px">
                
            </td>
        </tr>
        <tr>
            <td>
                <span id="ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberLocation">United States <img src="./A Network Sniffer in C# - CodeProject_files/US.gif" alt="United States" width="16px" height="11px"></span>
            </td>
        </tr>
        </tbody></table>
    </div>

    <div class="description">
        No Biography provided

        
    </div>

</div><br>
						
						

						<div class="clearfix"></div>

						<div style="padding-top:8px">
							
						</div>

					

				    
					</form>

				</div>

				
				<div class="bottom-promo"> 
				    <div class="msg-728x90" data-format="728x90" data-type="ad" data-publisher="lqm.codeproject.site" data-zone="General-Programming/Internet-Network/Utilities" data-country="US" data-loadonview="true" data-tags="C#, Windows, Visual-Studio, Dev, Intermediate,rating4.5,pos_bottom"><noscript><a href="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/General-Programming/Internet-Network/Utilities&sz=728x90&c=458212"><img src="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/General-Programming/Internet-Network/Utilities&sz=728x90&c=458212"  width="728px" height="90px" target="_blank"/></a></noscript></div>
				</div>
				
                
                

				
				

					<h2>Comments and Discussions</h2>
					<a class="float-left" name="_comments" id="_comments">&nbsp;</a><div id="_MessageBoardctl00_MessageBoard" onclick="return forumCtrl_ctl00_MessageBoard.SwitchMessage(event, null)">
<table id="ForumTable" class="forum relaxed" cellpadding="0" cellspacing="0">
<tbody><tr>
<td class="header1"><div class="callout">
	<b>You must <a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=%2fArticles%2f17031%2fA-Network-Sniffer-in-C%3ffid%3d373251%26df%3d90%26mpp%3d25%26sort%3dPosition%26view%3dNormal%26spc%3dRelaxed%26prof%3dTrue">Sign In</a> to use this message board.</b>
</div></td>
</tr><tr>
<td><table width="100%" border="0" cellpadding="3px" cellspacing="0">
<tbody><tr class="header1">
<td colspan="2" style="white-space:nowrap;"><div class="container">
<div class="float-right">
<form action="https://www.codeproject.com/Search.aspx?sbo=fm" method="get" class="searchbar">
<input type="hidden" name="fid" value="373251"><input type="hidden" name="sbo" value="fm"><input id="search_forumCtrl_ctl00_MessageBoard" type="search" class="search subdue" autocomplete="off" name="qf"><input type="image" src="./A Network Sniffer in C# - CodeProject_files/search.gif">
</form>
</div>
</div></td>
</tr><tr class="header2">
<td></td><td style="width:100%;"><div style="text-align:right;">
<form action="https://www.codeproject.com/script/Forums/SetOptions.aspx?fid=373251&amp;df=90&amp;mpp=25&amp;sort=Position&amp;view=Normal&amp;spc=Relaxed&amp;prof=True&amp;floc=%2fArticles%2f17031%2fA-Network-Sniffer-in-C" method="get" style="margin:0;padding:0;">
<input type="hidden" name="fid" value="373251"><input type="hidden" name="currentQS" value="fid=373251&amp;df=90&amp;mpp=25&amp;sort=Position&amp;view=Normal&amp;spc=Relaxed&amp;prof=True&amp;floc=%2fArticles%2f17031%2fA-Network-Sniffer-in-C"><input type="hidden" name="floc" value="/Articles/17031/A-Network-Sniffer-in-C">Spacing<select size="1" class="dropdown" name="spc">
<option selected="" value="Relaxed">Relaxed</option><option value="Compact">Compact</option><option value="Tight">Tight</option>
</select>&nbsp;&nbsp;Layout<select size="1" class="dropdown" name="view">
<option selected="" value="Normal">Normal</option><option value="Topic">Open Topics</option><option value="Expanded">Open All</option><option value="Thread">Thread View</option>
</select>&nbsp;&nbsp;Per page<select size="1" class="dropdown" name="mpp">
<option value="10">10</option><option selected="" value="25">25</option><option value="50">50</option>
</select>&nbsp;&nbsp;&nbsp;<input type="submit" value="Update" name="SetOpt" class="button">
</form>
</div></td>
</tr>
</tbody></table></td>
</tr><tr>
<td><a name="xx0xx"></a><table border="0" cellpadding="2px" cellspacing="0" width="100%">
<tbody><tr class="navbar">
<td></td><td style="text-align:right;width:50%;"></td><td style="text-align:right;white-space:nowrap;"><span class="nav-link disabled">First</span> <span class="nav-link disabled">Prev</span><a class="nav-link" name="Frm_HoverNL" href="https://www.codeproject.com/Articles/17031/A-Network-Sniffer-in-C?fid=373251&amp;df=90&amp;mpp=25&amp;sort=Position&amp;view=Normal&amp;spc=Relaxed&amp;prof=True&amp;fr=26#xx0xx">Next</a></td>
</tr>
</tbody></table></td>
</tr><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%" class="fixed-layout blank-background">
<tbody><tr id="F5665967_h0" class="header hover-row root">
<td class="subject-line normal " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="20px" class="indent"><a name="xx5665967xx"></a><img height="16px" width="16px" align="top" src="./A Network Sniffer in C# - CodeProject_files/msg_question.gif" alt="Question" title="Question"></td><td class="subject hover-container"><a class="message-link" name="5665967" parent="0" thread="5665967" href="https://www.codeproject.com/Messages/5665967/Hello-Im-korean.aspx">Hello. I'm korean.</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="https://www.codeproject.com/Articles/17031/A-Network-Sniffer-in-C#" title="Click to pin message"><img src="./A Network Sniffer in C# - CodeProject_files/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px"></a><div class="mobile-only">
	<span class="author">housdd</span><span class="date">25-Sep-19  20:31</span>
</div></td><td class="icon"><img border="0" src="./A Network Sniffer in C# - CodeProject_files/icn-member-16.gif" title="member" alt="member" height="16px"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=8130854">housdd</a></span></td><td class="date"><span>25-Sep-19  20:31&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F5665967_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:20px;"><span class="voteform vertical" ownerid="8130854" msgid="5665967" votingtype="GoodOrBad"></span></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2">byte 4096...<br>
<div class="pre-action-link" id="premain331014" style="width:100%;display:block;"><span id="prehide331014" onclick="processCodeBlocks.togglePre(331014);">Hide</span>  &nbsp; <span id="preShrink331014" onclick="processCodeBlocks.shrinkExpand(331014);">Shrink</span> <img id="preimg331014" src="./A Network Sniffer in C# - CodeProject_files/arrow-up-16.png" style="height:16px;width:16px" onclick="processCodeBlocks.shrinkExpand(331014);">  &nbsp; <span id="copycode331014" onclick="return processCodeBlocks.copyCode(331014);">Copy Code</span></div><pre id="pre331014" class="notranslate" style="margin-top: 0px;">Operation suddenly stops with an error in the data part. Is there a solution?
Is it a data size problem?</pre><br>
<br>
<br>
                int nReceived = mainSocket.EndReceive(ar);<br>
<br>
                //Analyze the bytes received...<br>
<br>
                ParseData(byteData, nReceived);<br>
<br>
                if (bContinueCapturing)<br>
                {<br>
                    byteData = new byte[4096];<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Articles/17031/A-Network-Sniffer-in-C" rel="nofollow noopener">Sign In</a>·<wbr><a href="https://www.codeproject.com/Articles/17031/A-Network-Sniffer-in-C?fid=373251&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=5665967" title="View Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span id="MVF5665967" data-ref="3_5665967" class="rating-label" name="RateItem_5665967"><span class="rating-result"><span></span></span></span><a href="https://www.codeproject.com/Messages/5665967/Hello-Im-korean.aspx" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="./A Network Sniffer in C# - CodeProject_files/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;</td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F5556055_h0" class="header hover-row root">
<td class="subject-line normal " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="20px" class="indent"><a name="xx5556055xx"></a><img height="16px" width="16px" align="top" src="./A Network Sniffer in C# - CodeProject_files/msg_question.gif" alt="Question" title="Question"></td><td class="subject hover-container"><a class="message-link" name="5556055" parent="0" thread="5556055" href="https://www.codeproject.com/Messages/5556055/Could-not-receive-incoming-message.aspx">Could not receive incoming message?</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="https://www.codeproject.com/Articles/17031/A-Network-Sniffer-in-C#" title="Click to pin message"><img src="./A Network Sniffer in C# - CodeProject_files/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px"></a><div class="mobile-only">
	<span class="author">cbfjay</span><span class="date">19-Sep-18  23:21</span>
</div></td><td class="icon"><img border="0" src="./A Network Sniffer in C# - CodeProject_files/icn-member-16.gif" title="member" alt="member" height="16px"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=9338344">cbfjay</a></span></td><td class="date"><span>19-Sep-18  23:21&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F5556055_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:20px;"><span class="voteform vertical" ownerid="9338344" msgid="5556055" votingtype="GoodOrBad"></span></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2">I try several times. I found that the incoming messages could not receive on the specific network adapter? Could you help me?<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Articles/17031/A-Network-Sniffer-in-C" rel="nofollow noopener">Sign In</a>·<wbr><a href="https://www.codeproject.com/Articles/17031/A-Network-Sniffer-in-C?fid=373251&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=5556055" title="View Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span id="MVF5556055" data-ref="3_5556055" class="rating-label" name="RateItem_5556055"><span class="rating-result"><span></span></span></span><a href="https://www.codeproject.com/Messages/5556055/Could-not-receive-incoming-message.aspx" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="./A Network Sniffer in C# - CodeProject_files/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;</td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F5556313_h0" class="header hover-row">
<td class="subject-line normal vote-hi " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="38px" class="indent"><a name="xx5556313xx"></a><img height="16px" width="16px" align="top" src="./A Network Sniffer in C# - CodeProject_files/msg_answer.gif" alt="Answer" title="Answer"></td><td class="subject hover-container"><a class="message-link" name="5556313" parent="5556055" thread="5556055" href="https://www.codeproject.com/Messages/5556313/Re-Could-not-receive-incoming-message.aspx">Re: Could not receive incoming message?</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="https://www.codeproject.com/Articles/17031/A-Network-Sniffer-in-C#" title="Click to pin message"><img src="./A Network Sniffer in C# - CodeProject_files/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px"></a><div class="mobile-only">
	<span class="author">cbfjay</span><span class="date">20-Sep-18  15:34</span>
</div></td><td class="icon"><img border="0" src="./A Network Sniffer in C# - CodeProject_files/icn-member-16.gif" title="member" alt="member" height="16px"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=9338344">cbfjay</a></span></td><td class="date"><span>20-Sep-18  15:34&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F5556313_h1" class="content selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:38px;"><span class="voteform vertical" ownerid="9338344" msgid="5556313" votingtype="GoodOrBad"></span></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2"><div class="parent"><a rel="nofollow noopener" onclick="return forumCtrl_ctl00_MessageBoard.SwitchMessage(null,5556055);" href="https://www.codeproject.com/Messages/5556055/Could-not-receive-incoming-message.aspx"><img src="./A Network Sniffer in C# - CodeProject_files/arrow-up24.png" title="Go to Parent" style="width:16px;height:16px;border:0"></a></div>I have already solved this problem. The main reason is that the FIREWALL blocking the incoming packets.<br>
<br>
You can try to close your FIREWALL, or allow specific connection port through the FIREWALL.<br>
<br>
Thanks to the answer from <a href="https://stackoverflow.com/questions/6334782/reading-incoming-packets-using-a-raw-socket-on-ip-protocol-in-c-sharp" rel="nofollow noopener">Reading incoming packets using a raw socket on IP protocol in C# - Stack Overflow</a>[<a href="https://stackoverflow.com/questions/6334782/reading-incoming-packets-using-a-raw-socket-on-ip-protocol-in-c-sharp" target="_blank" title="New Window" rel="nofollow noopener">^</a>]<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Articles/17031/A-Network-Sniffer-in-C" rel="nofollow noopener">Sign In</a>·<wbr><a href="https://www.codeproject.com/Articles/17031/A-Network-Sniffer-in-C?fid=373251&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=5556055" title="View Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span id="MVF5556313" data-ref="3_5556313" class="rating-label" name="RateItem_5556313"><span class="rating-result"><span></span></span></span><a href="https://www.codeproject.com/Messages/5556313/Re-Could-not-receive-incoming-message.aspx" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="./A Network Sniffer in C# - CodeProject_files/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;</td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F5447107_h0" class="header hover-row root">
<td class="subject-line normal " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="20px" class="indent"><a name="xx5447107xx"></a><img height="16px" width="16px" align="top" src="./A Network Sniffer in C# - CodeProject_files/msg_bug.gif" alt="Bug" title="Bug"></td><td class="subject hover-container"><a class="message-link" name="5447107" parent="0" thread="5447107" href="https://www.codeproject.com/Messages/5447107/Doesnt-work.aspx">Doesn't work</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="https://www.codeproject.com/Articles/17031/A-Network-Sniffer-in-C#" title="Click to pin message"><img src="./A Network Sniffer in C# - CodeProject_files/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px"></a><div class="mobile-only">
	<span class="author">Robert Everett</span><span class="date">22-Oct-17  5:33</span>
</div></td><td class="icon"><img border="0" src="./A Network Sniffer in C# - CodeProject_files/icn-member-16.gif" title="member" alt="member" height="16px"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=10668405">Robert Everett</a></span></td><td class="date"><span>22-Oct-17  5:33&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F5447107_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:20px;"><span class="voteform vertical" ownerid="10668405" msgid="5447107" votingtype="GoodOrBad"></span></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2"><div class="pre-action-link" id="premain498009" style="width:100%;display:block;"><span id="prehide498009" onclick="processCodeBlocks.togglePre(498009);">Hide</span>  &nbsp; <span id="preShrink498009" onclick="processCodeBlocks.shrinkExpand(498009);">Shrink</span> <img id="preimg498009" src="./A Network Sniffer in C# - CodeProject_files/arrow-up-16.png" style="height:16px;width:16px" onclick="processCodeBlocks.shrinkExpand(498009);">  &nbsp; <span id="copycode498009" onclick="return processCodeBlocks.copyCode(498009);">Copy Code</span></div><pre lang="c#" id="pre498009" class="notranslate" style="margin-top: 0px;">mainSocket = <span class="code-keyword">new</span> Socket(AddressFamily.InterNetwork, SocketType.Raw, ProtocolType.IP);</pre><br>
<br>
That line gives:<br>
"An attempt was made to access a socket in a way forbidden by its access permissions"<br>
<br>
Using Windows 10 64 bit<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Articles/17031/A-Network-Sniffer-in-C" rel="nofollow noopener">Sign In</a>·<wbr><a href="https://www.codeproject.com/Articles/17031/A-Network-Sniffer-in-C?fid=373251&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=5447107" title="View Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span id="MVF5447107" data-ref="3_5447107" class="rating-label" name="RateItem_5447107"><span class="rating-result"><span></span></span></span><a href="https://www.codeproject.com/Messages/5447107/Doesnt-work.aspx" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="./A Network Sniffer in C# - CodeProject_files/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;</td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F5447611_h0" class="header hover-row">
<td class="subject-line normal " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="38px" class="indent"><a name="xx5447611xx"></a><img height="16px" width="16px" align="top" src="./A Network Sniffer in C# - CodeProject_files/msg_general.gif" alt="General" title="General"></td><td class="subject hover-container"><a class="message-link" name="5447611" parent="5447107" thread="5447107" href="https://www.codeproject.com/Messages/5447611/Re-Doesnt-work.aspx">Re: Doesn't work</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="https://www.codeproject.com/Articles/17031/A-Network-Sniffer-in-C#" title="Click to pin message"><img src="./A Network Sniffer in C# - CodeProject_files/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px"></a><div class="mobile-only">
	<span class="author">Sims</span><span class="date">23-Oct-17  21:47</span>
</div></td><td class="icon"><img border="0" src="./A Network Sniffer in C# - CodeProject_files/icn-member-16.gif" title="member" alt="member" height="16px"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=79193">Sims</a></span></td><td class="date"><span>23-Oct-17  21:47&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F5447611_h1" class="content selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:38px;"><span class="voteform vertical" ownerid="79193" msgid="5447611" votingtype="GoodOrBad"></span></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2"><div class="parent"><a rel="nofollow noopener" onclick="return forumCtrl_ctl00_MessageBoard.SwitchMessage(null,5447107);" href="https://www.codeproject.com/Messages/5447107/Doesnt-work.aspx"><img src="./A Network Sniffer in C# - CodeProject_files/arrow-up24.png" title="Go to Parent" style="width:16px;height:16px;border:0"></a></div>You have to run as administrator.<br>
<br>
If you are trying to debug, then start Visual Studio as Administrator.<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Articles/17031/A-Network-Sniffer-in-C" rel="nofollow noopener">Sign In</a>·<wbr><a href="https://www.codeproject.com/Articles/17031/A-Network-Sniffer-in-C?fid=373251&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=5447107" title="View Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span id="MVF5447611" data-ref="3_5447611" class="rating-label" name="RateItem_5447611"><span class="rating-result"><span></span></span></span><a href="https://www.codeproject.com/Messages/5447611/Re-Doesnt-work.aspx" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="./A Network Sniffer in C# - CodeProject_files/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;</td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F5648357_h0" class="header hover-row">
<td class="subject-line normal " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="56px" class="indent"><a name="xx5648357xx"></a><img height="16px" width="16px" align="top" src="./A Network Sniffer in C# - CodeProject_files/msg_general.gif" alt="General" title="General"></td><td class="subject hover-container"><a class="message-link" name="5648357" parent="5447611" thread="5447107" href="https://www.codeproject.com/Messages/5648357/Re-Doesnt-work.aspx">Re: Doesn't work</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="https://www.codeproject.com/Articles/17031/A-Network-Sniffer-in-C#" title="Click to pin message"><img src="./A Network Sniffer in C# - CodeProject_files/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px"></a><div class="mobile-only">
	<span class="author">Ganther8</span><span class="date">30-Jul-19  23:21</span>
</div></td><td class="icon"><img border="0" src="./A Network Sniffer in C# - CodeProject_files/icn-member-16.gif" title="member" alt="member" height="16px"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=14538541">Ganther8</a></span></td><td class="date"><span>30-Jul-19  23:21&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F5648357_h1" class="content selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:56px;"><span class="voteform vertical" ownerid="14538541" msgid="5648357" votingtype="GoodOrBad"></span></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2"><div class="parent"><a rel="nofollow noopener" onclick="return forumCtrl_ctl00_MessageBoard.SwitchMessage(null,5447611);" href="https://www.codeproject.com/Messages/5447611/Re-Doesnt-work.aspx"><img src="./A Network Sniffer in C# - CodeProject_files/arrow-up24.png" title="Go to Parent" style="width:16px;height:16px;border:0"></a></div>Not OP, but running as admin also causes this exception.<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Articles/17031/A-Network-Sniffer-in-C" rel="nofollow noopener">Sign In</a>·<wbr><a href="https://www.codeproject.com/Articles/17031/A-Network-Sniffer-in-C?fid=373251&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=5447107" title="View Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span id="MVF5648357" data-ref="3_5648357" class="rating-label" name="RateItem_5648357"><span class="rating-result"><span></span></span></span><a href="https://www.codeproject.com/Messages/5648357/Re-Doesnt-work.aspx" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="./A Network Sniffer in C# - CodeProject_files/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;</td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F5441870_h0" class="header hover-row root">
<td class="subject-line normal " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="20px" class="indent"><a name="xx5441870xx"></a><img height="16px" width="16px" align="top" src="./A Network Sniffer in C# - CodeProject_files/msg_question.gif" alt="Question" title="Question"></td><td class="subject hover-container"><a class="message-link" name="5441870" parent="0" thread="5441870" href="https://www.codeproject.com/Messages/5441870/Data-miner.aspx">Data miner</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="https://www.codeproject.com/Articles/17031/A-Network-Sniffer-in-C#" title="Click to pin message"><img src="./A Network Sniffer in C# - CodeProject_files/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px"></a><div class="mobile-only">
	<span class="author">Member 11791529</span><span class="date">5-Oct-17  20:12</span>
</div></td><td class="icon"><img border="0" src="./A Network Sniffer in C# - CodeProject_files/icn-member-16.gif" title="member" alt="member" height="16px"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=11791529">Member 11791529</a></span></td><td class="date"><span>5-Oct-17  20:12&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F5441870_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:20px;"><span class="voteform vertical" ownerid="11791529" msgid="5441870" votingtype="GoodOrBad"></span></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2">Dear Sir,<br>
How can I meaning tcp data?<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Articles/17031/A-Network-Sniffer-in-C" rel="nofollow noopener">Sign In</a>·<wbr><a href="https://www.codeproject.com/Articles/17031/A-Network-Sniffer-in-C?fid=373251&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=5441870" title="View Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span id="MVF5441870" data-ref="3_5441870" class="rating-label" name="RateItem_5441870"><span class="rating-result"><span></span></span></span><a href="https://www.codeproject.com/Messages/5441870/Data-miner.aspx" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="./A Network Sniffer in C# - CodeProject_files/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;</td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F5422718_h0" class="header hover-row root">
<td class="subject-line normal " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="20px" class="indent"><a name="xx5422718xx"></a><img height="16px" width="16px" align="top" src="./A Network Sniffer in C# - CodeProject_files/msg_kudos.gif" alt="Praise" title="Praise"></td><td class="subject hover-container"><a class="message-link" name="5422718" parent="0" thread="5422718" href="https://www.codeproject.com/Messages/5422718/Outstanding-work.aspx">Outstanding work!</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="https://www.codeproject.com/Articles/17031/A-Network-Sniffer-in-C#" title="Click to pin message"><img src="./A Network Sniffer in C# - CodeProject_files/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px"></a><div class="mobile-only">
	<span class="author">Gil.Y</span><span class="date">5-Aug-17  14:46</span>
</div></td><td class="icon"><img border="0" src="./A Network Sniffer in C# - CodeProject_files/icn-member-16.gif" title="member" alt="member" height="16px"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=1997031">Gil.Y</a></span></td><td class="date"><span>5-Aug-17  14:46&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F5422718_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:20px;"><span class="voteform vertical" ownerid="1997031" msgid="5422718" votingtype="GoodOrBad"></span></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2">Thank you for this important article.<img src="./A Network Sniffer in C# - CodeProject_files/thumbs_up.gif" align="top" alt="Thumbs Up | :thumbsup:"> <img src="./A Network Sniffer in C# - CodeProject_files/thumbs_up.gif" align="top" alt="Thumbs Up | :thumbsup:"> <img src="./A Network Sniffer in C# - CodeProject_files/thumbs_up.gif" align="top" alt="Thumbs Up | :thumbsup:"> <img src="./A Network Sniffer in C# - CodeProject_files/thumbs_up.gif" align="top" alt="Thumbs Up | :thumbsup:"> <img src="./A Network Sniffer in C# - CodeProject_files/thumbs_up.gif" align="top" alt="Thumbs Up | :thumbsup:"><br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Articles/17031/A-Network-Sniffer-in-C" rel="nofollow noopener">Sign In</a>·<wbr><a href="https://www.codeproject.com/Articles/17031/A-Network-Sniffer-in-C?fid=373251&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=5422718" title="View Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span id="MVF5422718" data-ref="3_5422718" class="rating-label" name="RateItem_5422718"><span class="rating-result"><span></span></span></span><a href="https://www.codeproject.com/Messages/5422718/Outstanding-work.aspx" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="./A Network Sniffer in C# - CodeProject_files/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;</td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F5132715_h0" class="header hover-row root">
<td class="subject-line normal " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="20px" class="indent"><a name="xx5132715xx"></a><img height="16px" width="16px" align="top" src="./A Network Sniffer in C# - CodeProject_files/msg_question.gif" alt="Question" title="Question"></td><td class="subject hover-container"><a class="message-link" name="5132715" parent="0" thread="5132715" href="https://www.codeproject.com/Messages/5132715/report.aspx">report</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="https://www.codeproject.com/Articles/17031/A-Network-Sniffer-in-C#" title="Click to pin message"><img src="./A Network Sniffer in C# - CodeProject_files/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px"></a><div class="mobile-only">
	<span class="author">format C: /U</span><span class="date">23-Sep-15  21:07</span>
</div></td><td class="icon"><img border="0" src="./A Network Sniffer in C# - CodeProject_files/icn-member-16.gif" title="member" alt="member" height="16px"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=11856759">format C: /U</a></span></td><td class="date"><span>23-Sep-15  21:07&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F5132715_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:20px;"><span class="voteform vertical" ownerid="11856759" msgid="5132715" votingtype="GoodOrBad"></span></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2">sir/mam can you help me to provide a report for this code..?<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Articles/17031/A-Network-Sniffer-in-C" rel="nofollow noopener">Sign In</a>·<wbr><a href="https://www.codeproject.com/Articles/17031/A-Network-Sniffer-in-C?fid=373251&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=5132715" title="View Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span id="MVF5132715" data-ref="3_5132715" class="rating-label" name="RateItem_5132715"><span class="rating-result"><span></span></span></span><a href="https://www.codeproject.com/Messages/5132715/report.aspx" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="./A Network Sniffer in C# - CodeProject_files/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;</td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F5109485_h0" class="header hover-row root">
<td class="subject-line normal " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="20px" class="indent"><a name="xx5109485xx"></a><img height="16px" width="16px" align="top" src="./A Network Sniffer in C# - CodeProject_files/msg_question.gif" alt="Question" title="Question"></td><td class="subject hover-container"><a class="message-link" name="5109485" parent="0" thread="5109485" href="https://www.codeproject.com/Messages/5109485/Doesnt-work-with-ssl-traffic-Windows-10.aspx">Doesn't work with ssl traffic, Windows 10</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="https://www.codeproject.com/Articles/17031/A-Network-Sniffer-in-C#" title="Click to pin message"><img src="./A Network Sniffer in C# - CodeProject_files/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px"></a><div class="mobile-only">
	<span class="author">Dmytro Yeremieiev</span><span class="date">14-Aug-15  9:47</span>
</div></td><td class="icon"><img border="0" src="./A Network Sniffer in C# - CodeProject_files/icn-member-16.gif" title="member" alt="member" height="16px"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=10467759">Dmytro Yeremieiev</a></span></td><td class="date"><span>14-Aug-15  9:47&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F5109485_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:20px;"><span class="voteform vertical" ownerid="10467759" msgid="5109485" votingtype="GoodOrBad"></span></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2">Worked perfectly in windows 7, but after updated to windows 10, all ssl traffic captured encrypted. Do you have any ideas how to resolve this ? I wiil be happy to get ssl traffic too.<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Articles/17031/A-Network-Sniffer-in-C" rel="nofollow noopener">Sign In</a>·<wbr><a href="https://www.codeproject.com/Articles/17031/A-Network-Sniffer-in-C?fid=373251&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=5109485" title="View Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span id="MVF5109485" data-ref="3_5109485" class="rating-label" name="RateItem_5109485"><span class="rating-result"><span></span></span></span><a href="https://www.codeproject.com/Messages/5109485/Doesnt-work-with-ssl-traffic-Windows-10.aspx" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="./A Network Sniffer in C# - CodeProject_files/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;</td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F5067168_h0" class="header hover-row root">
<td class="subject-line normal " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="20px" class="indent"><a name="xx5067168xx"></a><img height="16px" width="16px" align="top" src="./A Network Sniffer in C# - CodeProject_files/msg_question.gif" alt="Question" title="Question"></td><td class="subject hover-container"><a class="message-link" name="5067168" parent="0" thread="5067168" href="https://www.codeproject.com/Messages/5067168/can-Internet-bandwidth-be-calculated-this-way.aspx">can Internet bandwidth be calculated this way?</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="https://www.codeproject.com/Articles/17031/A-Network-Sniffer-in-C#" title="Click to pin message"><img src="./A Network Sniffer in C# - CodeProject_files/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px"></a><div class="mobile-only">
	<span class="author">Amin Soltani</span><span class="date">31-May-15  21:32</span>
</div></td><td class="icon"><img border="0" src="./A Network Sniffer in C# - CodeProject_files/icn-member-16.gif" title="member" alt="member" height="16px"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=8426536">Amin Soltani</a></span></td><td class="date"><span>31-May-15  21:32&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F5067168_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:20px;"><span class="voteform vertical" ownerid="8426536" msgid="5067168" votingtype="GoodOrBad"></span></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2">I want to calculate  Internet bandwidth(without local usage).<br>
<br>
Can I use this way?<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Articles/17031/A-Network-Sniffer-in-C" rel="nofollow noopener">Sign In</a>·<wbr><a href="https://www.codeproject.com/Articles/17031/A-Network-Sniffer-in-C?fid=373251&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=5067168" title="View Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span id="MVF5067168" data-ref="3_5067168" class="rating-label" name="RateItem_5067168"><span class="rating-result"><span></span></span></span><a href="https://www.codeproject.com/Messages/5067168/can-Internet-bandwidth-be-calculated-this-way.aspx" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="./A Network Sniffer in C# - CodeProject_files/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;</td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F4897099_h0" class="header hover-row root">
<td class="subject-line normal " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="20px" class="indent"><a name="xx4897099xx"></a><img height="16px" width="16px" align="top" src="./A Network Sniffer in C# - CodeProject_files/msg_question.gif" alt="Question" title="Question"></td><td class="subject hover-container"><a class="message-link" name="4897099" parent="0" thread="4897099" href="https://www.codeproject.com/Messages/4897099/How-about-ARP.aspx">How about ARP?</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="https://www.codeproject.com/Articles/17031/A-Network-Sniffer-in-C#" title="Click to pin message"><img src="./A Network Sniffer in C# - CodeProject_files/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px"></a><div class="mobile-only">
	<span class="author">ASM2993</span><span class="date">5-Sep-14  3:59</span>
</div></td><td class="icon"><img border="0" src="./A Network Sniffer in C# - CodeProject_files/icn-pro-16.png" title="professional" alt="professional" height="16px"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=10482572">ASM2993</a></span></td><td class="date"><span>5-Sep-14  3:59&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F4897099_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:20px;"><span class="voteform vertical" ownerid="10482572" msgid="4897099" votingtype="GoodOrBad"></span></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2">How about ARP packets?<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Articles/17031/A-Network-Sniffer-in-C" rel="nofollow noopener">Sign In</a>·<wbr><a href="https://www.codeproject.com/Articles/17031/A-Network-Sniffer-in-C?fid=373251&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=4897099" title="View Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span id="MVF4897099" data-ref="3_4897099" class="rating-label" name="RateItem_4897099"><span class="rating-result"><span></span></span></span><a href="https://www.codeproject.com/Messages/4897099/How-about-ARP.aspx" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="./A Network Sniffer in C# - CodeProject_files/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;</td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F4914420_h0" class="header hover-row">
<td class="subject-line normal " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="38px" class="indent"><a name="xx4914420xx"></a><img height="16px" width="16px" align="top" src="./A Network Sniffer in C# - CodeProject_files/msg_answer.gif" alt="Answer" title="Answer"></td><td class="subject hover-container"><a class="message-link" name="4914420" parent="4897099" thread="4897099" href="https://www.codeproject.com/Messages/4914420/Re-How-about-ARP.aspx">Re: How about ARP?</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="https://www.codeproject.com/Articles/17031/A-Network-Sniffer-in-C#" title="Click to pin message"><img src="./A Network Sniffer in C# - CodeProject_files/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px"></a><div class="mobile-only">
	<span class="author">MiguelAntonio</span><span class="date">30-Sep-14  14:49</span>
</div></td><td class="icon"><img border="0" src="./A Network Sniffer in C# - CodeProject_files/icn-member-16.gif" title="member" alt="member" height="16px"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=1707203">MiguelAntonio</a></span></td><td class="date"><span>30-Sep-14  14:49&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F4914420_h1" class="content selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:38px;"><span class="voteform vertical" ownerid="1707203" msgid="4914420" votingtype="GoodOrBad"></span></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2"><div class="parent"><a rel="nofollow noopener" onclick="return forumCtrl_ctl00_MessageBoard.SwitchMessage(null,4897099);" href="https://www.codeproject.com/Messages/4897099/How-about-ARP.aspx"><img src="./A Network Sniffer in C# - CodeProject_files/arrow-up24.png" title="Go to Parent" style="width:16px;height:16px;border:0"></a></div>ARP is not an IP protocol, so will not work with this type of solution. You would need to use something like pcap to be able to get to the lower level packets.<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Articles/17031/A-Network-Sniffer-in-C" rel="nofollow noopener">Sign In</a>·<wbr><a href="https://www.codeproject.com/Articles/17031/A-Network-Sniffer-in-C?fid=373251&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=4897099" title="View Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span id="MVF4914420" data-ref="3_4914420" class="rating-label" name="RateItem_4914420"><span class="rating-result"><span></span></span></span><a href="https://www.codeproject.com/Messages/4914420/Re-How-about-ARP.aspx" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="./A Network Sniffer in C# - CodeProject_files/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;</td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F4872917_h0" class="header hover-row root">
<td class="subject-line normal " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="20px" class="indent"><a name="xx4872917xx"></a><img height="16px" width="16px" align="top" src="./A Network Sniffer in C# - CodeProject_files/msg_general.gif" alt="General" title="General"></td><td class="subject hover-container"><a class="message-link" name="4872917" parent="0" thread="4872917" href="https://www.codeproject.com/Messages/4872917/My-vote-of-4.aspx">My vote of 4</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="https://www.codeproject.com/Articles/17031/A-Network-Sniffer-in-C#" title="Click to pin message"><img src="./A Network Sniffer in C# - CodeProject_files/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px"></a><div class="mobile-only">
	<span class="author">Herre Kuijpers</span><span class="date">30-Jul-14  10:36</span>
</div></td><td class="icon"><img border="0" src="./A Network Sniffer in C# - CodeProject_files/icn-member-16.gif" title="member" alt="member" height="16px"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=2192187">Herre Kuijpers</a></span></td><td class="date"><span>30-Jul-14  10:36&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F4872917_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:20px;"><span class="voteform vertical" ownerid="2192187" msgid="4872917" votingtype="GoodOrBad"></span></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2">nice, finally a simple easy to use sniffer that works right out of the box without installing all kinds of other drivers.<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Articles/17031/A-Network-Sniffer-in-C" rel="nofollow noopener">Sign In</a>·<wbr><a href="https://www.codeproject.com/Articles/17031/A-Network-Sniffer-in-C?fid=373251&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=4872917" title="View Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span id="MVF4872917" data-ref="3_4872917" class="rating-label" name="RateItem_4872917"><span class="rating-result"><span></span></span></span><a href="https://www.codeproject.com/Messages/4872917/My-vote-of-4.aspx" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="./A Network Sniffer in C# - CodeProject_files/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;</td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F4869518_h0" class="header hover-row root">
<td class="subject-line normal " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="20px" class="indent"><a name="xx4869518xx"></a><img height="16px" width="16px" align="top" src="./A Network Sniffer in C# - CodeProject_files/msg_question.gif" alt="Question" title="Question"></td><td class="subject hover-container"><a class="message-link" name="4869518" parent="0" thread="4869518" href="https://www.codeproject.com/Messages/4869518/empty-zip-source-file.aspx">empty zip source file</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="https://www.codeproject.com/Articles/17031/A-Network-Sniffer-in-C#" title="Click to pin message"><img src="./A Network Sniffer in C# - CodeProject_files/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px"></a><div class="mobile-only">
	<span class="author">Member 10406823</span><span class="date">25-Jul-14  16:55</span>
</div></td><td class="icon"><img border="0" src="./A Network Sniffer in C# - CodeProject_files/icn-pro-16.png" title="professional" alt="professional" height="16px"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=10406823">Member 10406823</a></span></td><td class="date"><span>25-Jul-14  16:55&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F4869518_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:20px;"><span class="voteform vertical" ownerid="10406823" msgid="4869518" votingtype="GoodOrBad"></span></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2">Why the source file posted on this subject is empty? It's only 24.6kb with the name of MJsniffer.zip<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Articles/17031/A-Network-Sniffer-in-C" rel="nofollow noopener">Sign In</a>·<wbr><a href="https://www.codeproject.com/Articles/17031/A-Network-Sniffer-in-C?fid=373251&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=4869518" title="View Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span id="MVF4869518" data-ref="3_4869518" class="rating-label" name="RateItem_4869518"><span class="rating-result"><span></span></span></span><a href="https://www.codeproject.com/Messages/4869518/empty-zip-source-file.aspx" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="./A Network Sniffer in C# - CodeProject_files/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;</td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F4844449_h0" class="header hover-row root">
<td class="subject-line normal vote-hi " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="20px" class="indent"><a name="xx4844449xx"></a><img height="16px" width="16px" align="top" src="./A Network Sniffer in C# - CodeProject_files/msg_question.gif" alt="Question" title="Question"></td><td class="subject hover-container"><a class="message-link" name="4844449" parent="0" thread="4844449" href="https://www.codeproject.com/Messages/4844449/the-attempted-opeartion-is-not-supported-for-the-t.aspx">the attempted opeartion is not supported for the type of object refranced</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="https://www.codeproject.com/Articles/17031/A-Network-Sniffer-in-C#" title="Click to pin message"><img src="./A Network Sniffer in C# - CodeProject_files/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px"></a><div class="mobile-only">
	<span class="author">AminMhmdi</span><span class="date">18-Jun-14  16:08</span>
</div></td><td class="icon"><img border="0" src="./A Network Sniffer in C# - CodeProject_files/icn-pro-16.png" title="professional" alt="professional" height="16px"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=7428881">AminMhmdi</a></span></td><td class="date"><span>18-Jun-14  16:08&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F4844449_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:20px;"><span class="voteform vertical" ownerid="7428881" msgid="4844449" votingtype="GoodOrBad"></span></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2">when i select interface and click start i get this message <br>
"the attempted operation is not supported for the type of object referenced"<br>
<br>
also i cant run program in visual studio when i click debug vs show me error<br>
'The Microsoft Visual Studio Remote Debugging Monitor (MSVSMON.EXE) does not appear to be running on the remote computer.<br>
how can i solve it??<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Articles/17031/A-Network-Sniffer-in-C" rel="nofollow noopener">Sign In</a>·<wbr><a href="https://www.codeproject.com/Articles/17031/A-Network-Sniffer-in-C?fid=373251&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=4844449" title="View Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span id="MVF4844449" data-ref="3_4844449" class="rating-label" name="RateItem_4844449"><span class="rating-result"><span></span></span></span><a href="https://www.codeproject.com/Messages/4844449/the-attempted-opeartion-is-not-supported-for-the-t.aspx" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="./A Network Sniffer in C# - CodeProject_files/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;</td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F4785200_h0" class="header hover-row root">
<td class="subject-line normal " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="20px" class="indent"><a name="xx4785200xx"></a><img height="16px" width="16px" align="top" src="./A Network Sniffer in C# - CodeProject_files/msg_general.gif" alt="General" title="General"></td><td class="subject hover-container"><a class="message-link" name="4785200" parent="0" thread="4785200" href="https://www.codeproject.com/Messages/4785200/My-vote-of-5.aspx">My vote of 5</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="https://www.codeproject.com/Articles/17031/A-Network-Sniffer-in-C#" title="Click to pin message"><img src="./A Network Sniffer in C# - CodeProject_files/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px"></a><div class="mobile-only">
	<span class="author">Member 10686604</span><span class="date">24-Mar-14  5:14</span>
</div></td><td class="icon"><img border="0" src="./A Network Sniffer in C# - CodeProject_files/icn-member-16.gif" title="member" alt="member" height="16px"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=10686604">Member 10686604</a></span></td><td class="date"><span>24-Mar-14  5:14&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F4785200_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:20px;"><span class="voteform vertical" ownerid="10686604" msgid="4785200" votingtype="GoodOrBad"></span></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2">extremely helpful!<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Articles/17031/A-Network-Sniffer-in-C" rel="nofollow noopener">Sign In</a>·<wbr><a href="https://www.codeproject.com/Articles/17031/A-Network-Sniffer-in-C?fid=373251&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=4785200" title="View Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span id="MVF4785200" data-ref="3_4785200" class="rating-label" name="RateItem_4785200"><span class="rating-result"><span></span></span></span><a href="https://www.codeproject.com/Messages/4785200/My-vote-of-5.aspx" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="./A Network Sniffer in C# - CodeProject_files/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;</td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F4753847_h0" class="header hover-row root">
<td class="subject-line normal " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="20px" class="indent"><a name="xx4753847xx"></a><img height="16px" width="16px" align="top" src="./A Network Sniffer in C# - CodeProject_files/msg_question.gif" alt="Question" title="Question"></td><td class="subject hover-container"><a class="message-link" name="4753847" parent="0" thread="4753847" href="https://www.codeproject.com/Messages/4753847/Double-packets.aspx">Double packets</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="https://www.codeproject.com/Articles/17031/A-Network-Sniffer-in-C#" title="Click to pin message"><img src="./A Network Sniffer in C# - CodeProject_files/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px"></a><div class="mobile-only">
	<span class="author">PSU Mike</span><span class="date">7-Feb-14  1:11</span>
</div></td><td class="icon"><img border="0" src="./A Network Sniffer in C# - CodeProject_files/icn-member-16.gif" title="member" alt="member" height="16px"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=4090419">PSU Mike</a></span></td><td class="date"><span>7-Feb-14  1:11&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F4753847_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:20px;"><span class="voteform vertical" ownerid="4090419" msgid="4753847" votingtype="GoodOrBad"></span></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2">I've implemented this approach and in testing, the OnReceive method is being called twice with the same packet data.  The only difference is that the IP checksum on one packet is always 0x00.<br>
<br>
Easy to filter out, but I'd like to know why.  I'm testing using traffic generated on my local machine from a test program.  <br>
<br>
Thought maybe something to do with the loopback interface, but I test to open the IPv4 address of the local machine.<br>
<br>
Thoughts?<br>
<br>
Mike<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Articles/17031/A-Network-Sniffer-in-C" rel="nofollow noopener">Sign In</a>·<wbr><a href="https://www.codeproject.com/Articles/17031/A-Network-Sniffer-in-C?fid=373251&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=4753847" title="View Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span id="MVF4753847" data-ref="3_4753847" class="rating-label" name="RateItem_4753847"><span class="rating-result"><span></span></span></span><a href="https://www.codeproject.com/Messages/4753847/Double-packets.aspx" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="./A Network Sniffer in C# - CodeProject_files/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;</td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F4717610_h0" class="header hover-row root">
<td class="subject-line normal " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="20px" class="indent"><a name="xx4717610xx"></a><img height="16px" width="16px" align="top" src="./A Network Sniffer in C# - CodeProject_files/msg_general.gif" alt="General" title="General"></td><td class="subject hover-container"><a class="message-link" name="4717610" parent="0" thread="4717610" href="https://www.codeproject.com/Messages/4717610/My-vote-of-1.aspx">My vote of 1</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="https://www.codeproject.com/Articles/17031/A-Network-Sniffer-in-C#" title="Click to pin message"><img src="./A Network Sniffer in C# - CodeProject_files/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px"></a><div class="mobile-only">
	<span class="author">applemeteor</span><span class="date">8-Dec-13  18:27</span>
</div></td><td class="icon"><img border="0" src="./A Network Sniffer in C# - CodeProject_files/icn-member-16.gif" title="member" alt="member" height="16px"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=9418210">applemeteor</a></span></td><td class="date"><span>8-Dec-13  18:27&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F4717610_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:20px;"><span class="voteform vertical" ownerid="9418210" msgid="4717610" votingtype="GoodOrBad"></span></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2">能下载否？<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Articles/17031/A-Network-Sniffer-in-C" rel="nofollow noopener">Sign In</a>·<wbr><a href="https://www.codeproject.com/Articles/17031/A-Network-Sniffer-in-C?fid=373251&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=4717610" title="View Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span id="MVF4717610" data-ref="3_4717610" class="rating-label" name="RateItem_4717610"><span class="rating-result"><span></span></span></span><a href="https://www.codeproject.com/Messages/4717610/My-vote-of-1.aspx" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="./A Network Sniffer in C# - CodeProject_files/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;</td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F4581587_h0" class="header hover-row root">
<td class="subject-line normal vote-hi " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="20px" class="indent"><a name="xx4581587xx"></a><img height="16px" width="16px" align="top" src="./A Network Sniffer in C# - CodeProject_files/msg_question.gif" alt="Question" title="Question"></td><td class="subject hover-container"><a class="message-link" name="4581587" parent="0" thread="4581587" href="https://www.codeproject.com/Messages/4581587/how-to-tell-income-or-outgoing.aspx">how to tell income or outgoing</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="https://www.codeproject.com/Articles/17031/A-Network-Sniffer-in-C#" title="Click to pin message"><img src="./A Network Sniffer in C# - CodeProject_files/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px"></a><div class="mobile-only">
	<span class="author">Huisheng Chen</span><span class="date">6-Jun-13  4:30</span>
</div></td><td class="icon"><img border="0" src="./A Network Sniffer in C# - CodeProject_files/icn-member-16.gif" title="member" alt="member" height="16px"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=750345">Huisheng Chen</a></span></td><td class="date"><span>6-Jun-13  4:30&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F4581587_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:20px;"><span class="voteform vertical" ownerid="750345" msgid="4581587" votingtype="GoodOrBad"></span></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2">how to tell whether a packet is incoming or outgoing? depending on the source/destination? <br>
<br>
if destination is remote then outgoing, and if destination is local then incoming?<br>
<div class="signature">Regards,<br>
unruledboy_at_gmail_dot_com<br>
http://www.xnlab.com</div><br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Articles/17031/A-Network-Sniffer-in-C" rel="nofollow noopener">Sign In</a>·<wbr><a href="https://www.codeproject.com/Articles/17031/A-Network-Sniffer-in-C?fid=373251&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=4581587" title="View Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span id="MVF4581587" data-ref="3_4581587" class="rating-label" name="RateItem_4581587"><span class="rating-result"><span></span></span></span><a href="https://www.codeproject.com/Messages/4581587/how-to-tell-income-or-outgoing.aspx" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="./A Network Sniffer in C# - CodeProject_files/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;</td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F4547329_h0" class="header hover-row root">
<td class="subject-line normal vote-hi " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="20px" class="indent"><a name="xx4547329xx"></a><img height="16px" width="16px" align="top" src="./A Network Sniffer in C# - CodeProject_files/msg_question.gif" alt="Question" title="Question"></td><td class="subject hover-container"><a class="message-link" name="4547329" parent="0" thread="4547329" href="https://www.codeproject.com/Messages/4547329/Trying-to-sniff-on-a-local-network.aspx">Trying to sniff on a local network</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="https://www.codeproject.com/Articles/17031/A-Network-Sniffer-in-C#" title="Click to pin message"><img src="./A Network Sniffer in C# - CodeProject_files/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px"></a><div class="mobile-only">
	<span class="author">Hammett1993</span><span class="date">22-Apr-13  10:11</span>
</div></td><td class="icon"><img border="0" src="./A Network Sniffer in C# - CodeProject_files/icn-member-16.gif" title="member" alt="member" height="16px"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=9981007">Hammett1993</a></span></td><td class="date"><span>22-Apr-13  10:11&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F4547329_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:20px;"><span class="voteform vertical" ownerid="9981007" msgid="4547329" votingtype="GoodOrBad"></span></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2">I tried to sniff a computer on my local network but i didn't succeed.<br>
I can get the ip adress of all the computers connected to my local network but then i tried to sniff one of the adress, i get an error telling que that my ip adress isn't valid in this context and i didn't find why.<br>
<br>
Thank you in advance fo your reply.<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Articles/17031/A-Network-Sniffer-in-C" rel="nofollow noopener">Sign In</a>·<wbr><a href="https://www.codeproject.com/Articles/17031/A-Network-Sniffer-in-C?fid=373251&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=4547329" title="View Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span id="MVF4547329" data-ref="3_4547329" class="rating-label" name="RateItem_4547329"><span class="rating-result"><span></span></span></span><a href="https://www.codeproject.com/Messages/4547329/Trying-to-sniff-on-a-local-network.aspx" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="./A Network Sniffer in C# - CodeProject_files/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;</td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F5492750_h0" class="header hover-row">
<td class="subject-line normal " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="38px" class="indent"><a name="xx5492750xx"></a><img height="16px" width="16px" align="top" src="./A Network Sniffer in C# - CodeProject_files/msg_answer.gif" alt="Answer" title="Answer"></td><td class="subject hover-container"><a class="message-link" name="5492750" parent="4547329" thread="4547329" href="https://www.codeproject.com/Messages/5492750/Re-Trying-to-sniff-on-a-local-network.aspx">Re: Trying to sniff on a local network</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="https://www.codeproject.com/Articles/17031/A-Network-Sniffer-in-C#" title="Click to pin message"><img src="./A Network Sniffer in C# - CodeProject_files/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px"></a><div class="mobile-only">
	<span class="author">Michał Heliński</span><span class="date">22-Feb-18  0:19</span>
</div></td><td class="icon"><img border="0" src="./A Network Sniffer in C# - CodeProject_files/icn-member-16.gif" title="member" alt="member" height="16px"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=7642264">Michał Heliński</a></span></td><td class="date"><span>22-Feb-18  0:19&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F5492750_h1" class="content selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:38px;"><span class="voteform vertical" ownerid="7642264" msgid="5492750" votingtype="GoodOrBad"></span></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2"><div class="parent"><a rel="nofollow noopener" onclick="return forumCtrl_ctl00_MessageBoard.SwitchMessage(null,4547329);" href="https://www.codeproject.com/Messages/4547329/Trying-to-sniff-on-a-local-network.aspx"><img src="./A Network Sniffer in C# - CodeProject_files/arrow-up24.png" title="Go to Parent" style="width:16px;height:16px;border:0"></a></div>Did you get any solution?<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Articles/17031/A-Network-Sniffer-in-C" rel="nofollow noopener">Sign In</a>·<wbr><a href="https://www.codeproject.com/Articles/17031/A-Network-Sniffer-in-C?fid=373251&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=4547329" title="View Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span id="MVF5492750" data-ref="3_5492750" class="rating-label" name="RateItem_5492750"><span class="rating-result"><span></span></span></span><a href="https://www.codeproject.com/Messages/5492750/Re-Trying-to-sniff-on-a-local-network.aspx" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="./A Network Sniffer in C# - CodeProject_files/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;</td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F4489985_h0" class="header hover-row root">
<td class="subject-line normal vote-hi " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="20px" class="indent"><a name="xx4489985xx"></a><img height="16px" width="16px" align="top" src="./A Network Sniffer in C# - CodeProject_files/msg_question.gif" alt="Question" title="Question"></td><td class="subject hover-container"><a class="message-link" name="4489985" parent="0" thread="4489985" href="https://www.codeproject.com/Messages/4489985/Start-Sniff-while-Cable-Disconnected.aspx">Start Sniff while Cable Disconnected?</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="https://www.codeproject.com/Articles/17031/A-Network-Sniffer-in-C#" title="Click to pin message"><img src="./A Network Sniffer in C# - CodeProject_files/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px"></a><div class="mobile-only">
	<span class="author">Ali Fakoor</span><span class="date">6-Feb-13  19:31</span>
</div></td><td class="icon"><img border="0" src="./A Network Sniffer in C# - CodeProject_files/icn-member-16.gif" title="member" alt="member" height="16px"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=1549335">Ali Fakoor</a></span></td><td class="date"><span>6-Feb-13  19:31&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F4489985_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:20px;"><span class="voteform vertical" ownerid="1549335" msgid="4489985" votingtype="GoodOrBad"></span></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2">Thanks for the great piece of work. I had a question: <br>
<br>
Is it possible to begin capturing on a network interface when the media cable is disconnected? (Then, whenever the cable is plugged in, we will start receiving the packets)<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Articles/17031/A-Network-Sniffer-in-C" rel="nofollow noopener">Sign In</a>·<wbr><a href="https://www.codeproject.com/Articles/17031/A-Network-Sniffer-in-C?fid=373251&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=4489985" title="View Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span id="MVF4489985" data-ref="3_4489985" class="rating-label" name="RateItem_4489985"><span class="rating-result"><span></span></span></span><a href="https://www.codeproject.com/Messages/4489985/Start-Sniff-while-Cable-Disconnected.aspx" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="./A Network Sniffer in C# - CodeProject_files/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;</td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F4457528_h0" class="header hover-row root">
<td class="subject-line normal " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="20px" class="indent"><a name="xx4457528xx"></a><img height="16px" width="16px" align="top" src="./A Network Sniffer in C# - CodeProject_files/msg_question.gif" alt="Question" title="Question"></td><td class="subject hover-container"><a class="message-link" name="4457528" parent="0" thread="4457528" href="https://www.codeproject.com/Messages/4457528/Problem-with-VISTA.aspx">Problem with VISTA</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="https://www.codeproject.com/Articles/17031/A-Network-Sniffer-in-C#" title="Click to pin message"><img src="./A Network Sniffer in C# - CodeProject_files/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px"></a><div class="mobile-only">
	<span class="author">dontumindit</span><span class="date">20-Dec-12  21:15</span>
</div></td><td class="icon"><img border="0" src="./A Network Sniffer in C# - CodeProject_files/icn-member-16.gif" title="member" alt="member" height="16px"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=7160699">dontumindit</a></span></td><td class="date"><span>20-Dec-12  21:15&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F4457528_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:20px;"><span class="voteform vertical" ownerid="7160699" msgid="4457528" votingtype="GoodOrBad"></span></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2">the code is not capturing tcp packets in vista<br>
<br>
it only shows udp packets in tree view<br>
<br>
any solution?<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Articles/17031/A-Network-Sniffer-in-C" rel="nofollow noopener">Sign In</a>·<wbr><a href="https://www.codeproject.com/Articles/17031/A-Network-Sniffer-in-C?fid=373251&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=4457528" title="View Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span id="MVF4457528" data-ref="3_4457528" class="rating-label" name="RateItem_4457528"><span class="rating-result"><span></span></span></span><a href="https://www.codeproject.com/Messages/4457528/Problem-with-VISTA.aspx" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="./A Network Sniffer in C# - CodeProject_files/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;</td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F4448909_h0" class="header hover-row root">
<td class="subject-line normal " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="20px" class="indent"><a name="xx4448909xx"></a><img height="16px" width="16px" align="top" src="./A Network Sniffer in C# - CodeProject_files/msg_question.gif" alt="Question" title="Question"></td><td class="subject hover-container"><a class="message-link" name="4448909" parent="0" thread="4448909" href="https://www.codeproject.com/Messages/4448909/Network-problems.aspx">Network problems</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="https://www.codeproject.com/Articles/17031/A-Network-Sniffer-in-C#" title="Click to pin message"><img src="./A Network Sniffer in C# - CodeProject_files/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px"></a><div class="mobile-only">
	<span class="author">AJMAL SHAHZAD</span><span class="date">10-Dec-12  18:45</span>
</div></td><td class="icon"><img border="0" src="./A Network Sniffer in C# - CodeProject_files/icn-member-16.gif" title="member" alt="member" height="16px"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=6406609">AJMAL SHAHZAD</a></span></td><td class="date"><span>10-Dec-12  18:45&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F4448909_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:20px;"><span class="voteform vertical" ownerid="6406609" msgid="4448909" votingtype="GoodOrBad"></span></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2">what type of network problems we can solve using this application or what are advantages of this application ? <img src="./A Network Sniffer in C# - CodeProject_files/smiley_doh.gif" align="top" alt="D&#39;Oh! | :doh:"><br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Articles/17031/A-Network-Sniffer-in-C" rel="nofollow noopener">Sign In</a>·<wbr><a href="https://www.codeproject.com/Articles/17031/A-Network-Sniffer-in-C?fid=373251&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=4448909" title="View Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span id="MVF4448909" data-ref="3_4448909" class="rating-label" name="RateItem_4448909"><span class="rating-result"><span></span></span></span><a href="https://www.codeproject.com/Messages/4448909/Network-problems.aspx" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="./A Network Sniffer in C# - CodeProject_files/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;</td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr>
<td><table width="100%" cellpadding="2px" cellspacing="0">
<tbody><tr class="footer">
<td><span class="last-visit desktop-only tablet-only">Last Visit: 6-Oct-19  5:11 &nbsp; &nbsp; Last Update: 6-Oct-19  5:11</span></td><td><a rel="nofollow" href="https://www.codeproject.com/Articles/17031/A-Network-Sniffer-in-C?fid=373251&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;prof=True&amp;view=Normal">Refresh</a></td><td style="text-align:right;white-space:nowrap;"><input id="_mbnUrl" type="hidden" value="/Articles/17031/A-Network-Sniffer-in-C?fid=373251&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;prof=True&amp;view=Normal&amp;fr=26"><span class="nav-link selected">1</span><a class="nav-link" name="Frm_HoverNL" href="https://www.codeproject.com/Articles/17031/A-Network-Sniffer-in-C?fid=373251&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;prof=True&amp;view=Normal&amp;fr=26#xx0xx">2</a><a class="nav-link" name="Frm_HoverNL" href="https://www.codeproject.com/Articles/17031/A-Network-Sniffer-in-C?fid=373251&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;prof=True&amp;view=Normal&amp;fr=51#xx0xx">3</a><a class="nav-link" name="Frm_HoverNL" href="https://www.codeproject.com/Articles/17031/A-Network-Sniffer-in-C?fid=373251&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;prof=True&amp;view=Normal&amp;fr=76#xx0xx">4</a><a class="nav-link" name="Frm_HoverNL" href="https://www.codeproject.com/Articles/17031/A-Network-Sniffer-in-C?fid=373251&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;prof=True&amp;view=Normal&amp;fr=101#xx0xx">5</a><a class="nav-link" name="Frm_HoverNL" href="https://www.codeproject.com/Articles/17031/A-Network-Sniffer-in-C?fid=373251&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;prof=True&amp;view=Normal&amp;fr=126#xx0xx">6</a><a class="nav-link" name="Frm_HoverNL" href="https://www.codeproject.com/Articles/17031/A-Network-Sniffer-in-C?fid=373251&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;prof=True&amp;view=Normal&amp;fr=151#xx0xx">7</a> <a class="nav-link" name="Frm_HoverNL" href="https://www.codeproject.com/Articles/17031/A-Network-Sniffer-in-C?fid=373251&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;prof=True&amp;view=Normal&amp;fr=26#xx0xx">Next »</a></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table>
</div><p class="small-text"><img align="top" src="./A Network Sniffer in C# - CodeProject_files/msg_general.gif" width="16px" height="16px" alt="General"> General &nbsp;&nbsp; <img align="top" src="./A Network Sniffer in C# - CodeProject_files/msg_news.gif" width="16px" height="16px" alt="News"> News &nbsp;&nbsp; <img align="top" src="./A Network Sniffer in C# - CodeProject_files/msg_idea.gif" width="16px" height="16px" alt="Suggestion"> Suggestion &nbsp;&nbsp; <img align="top" src="./A Network Sniffer in C# - CodeProject_files/msg_question.gif" width="16px" height="16px" alt="Question"> Question &nbsp;&nbsp; <img align="top" src="./A Network Sniffer in C# - CodeProject_files/msg_bug.gif" width="16px" height="16px" alt="Bug"> Bug &nbsp;&nbsp; <img align="top" src="./A Network Sniffer in C# - CodeProject_files/msg_answer.gif" width="16px" height="16px" alt="Answer"> Answer &nbsp;&nbsp; <img align="top" src="./A Network Sniffer in C# - CodeProject_files/msg_joke.gif" width="16px" height="16px" alt="Joke"> Joke &nbsp;&nbsp; <img align="top" src="./A Network Sniffer in C# - CodeProject_files/msg_kudos.gif" width="16px" height="16px" alt="Praise"> Praise &nbsp;&nbsp; <img align="top" src="./A Network Sniffer in C# - CodeProject_files/msg_rant.gif" width="16px" height="16px" alt="Rant"> Rant &nbsp;&nbsp; <img align="top" src="./A Network Sniffer in C# - CodeProject_files/msg_admin.gif" width="16px" height="16px" alt="Admin"> Admin &nbsp;&nbsp; </p><p class="small-text">Use Ctrl+Left/Right to switch messages, Ctrl+Up/Down to switch threads, Ctrl+Shift+Left/Right to switch pages.</p>
				

			</div>
			

			
		    <div id="ctl00_LeftSideBar" class="article-left-sidebar">

                <div id="ctl00_StickyBlock" class="article-left-sidebar-inner stuck" style="position: fixed; top: 10px; left: 112.333px;">
                    
    		        

<div class="tabs">
	<div class=" selected">Article</div>
<div class="browse-code"><a href="https://www.codeproject.com/script/Articles/ViewDownloads.aspx?aid=17031">Browse Code</a></div>
<div><a href="https://www.codeproject.com/script/Articles/Statistics.aspx?aid=17031">View Stats</a></div>
<div><a href="https://www.codeproject.com/script/Articles/ListVersions.aspx?aid=17031">Revisions</a></div>
<div><a href="https://www.codeproject.com/Articles/17031/A-Network-Sniffer-in-C#_comments">Comments (152)</a></div>
<div>Posted 5 Jan 2007</div>


    
</div>



			        

			        <div>
                        <h4 id="ctl00_TaggedAsWrapper">Tagged as</h4>
			            <span id="ctl00_TagList_TagWrp" class="tags vertical">

	
	

	
	<span id="ctl00_TagList_VisibleTags"><div class="t"><a rel="tag" href="https://www.codeproject.com/Tags/sharp" data-id="81">C#</a></div><div class="t"><a rel="tag" href="https://www.codeproject.com/Tags/Windows" data-id="94">Windows</a></div><div class="t"><a rel="tag" href="https://www.codeproject.com/Tags/Visual-Studio" data-id="103">Visual-Studio</a></div></span> 

	
	
</span>


			        </div>

                    <div id="ctl00_VerticalStatsWrapper" class="stats">
                    <h4>Stats</h4>
                    <div id="ctl00_VerticalStats"><div class="stats"><div>724.8K views</div><div>42.6K downloads</div><div>331 bookmarked</div></div></div>
                    </div>

                    
                </div>
		    </div>
            

            
            <div id="ctl00_RightSideBar" class="article-right-sidebar">

                <div id="RHSticky" class="container-article-info-sticky stuck" style="position: fixed; top: 10px; left: 973.333px;">
        		    

<div class="article-summary">

    
    

</div>

				    <div id="ctl00_SectionSponsor" class="padded-top" style="width:160px;margin:10px auto">
					    <div class="msg-160x200" data-format="160x200" data-type="ad" data-publisher="lqm.codeproject.site" data-zone="General-Programming/Internet-Network/Utilities" data-country="US" data-showindicator="true" data-tags="C#, Windows, Visual-Studio, Dev, Intermediate,rating4.5"><noscript><a href="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/General-Programming/Internet-Network/Utilities&sz=160x200&c=708026"><img src="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/General-Programming/Internet-Network/Utilities&sz=160x200&c=708026"  width="160px" height="200px" target="_blank"/></a></noscript><div id="div-gpt-ad-lqm.codeproject.site/General-Programming/Internet-Network/Utilities-4" style="height: 200px; width: 160px; box-sizing: border-box; border: 0px; font-size: 0px;"><div id="google_ads_iframe_/6839/lqm.codeproject.site/General-Programming/Internet-Network/Utilities_0__container__" style="border: 0pt none; width: 160px; height: 200px;"></div></div></div>
				    </div>

				    <div style="width:160px;margin: 10px auto;">
					    <div class="msg-160x600" data-format="160x600" data-type="ad" data-publisher="lqm.codeproject.site" data-zone="General-Programming/Internet-Network/Utilities" data-country="US" data-tags="C#, Windows, Visual-Studio, Dev, Intermediate,rating4.5"><noscript><a href="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/General-Programming/Internet-Network/Utilities&sz=160x600&c=708026"><img src="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/General-Programming/Internet-Network/Utilities&sz=160x600&c=708026"  width="160px" height="600px" target="_blank"/></a></noscript><div id="div-gpt-ad-lqm.codeproject.site/General-Programming/Internet-Network/Utilities-5" style="height: 600px; width: 160px; box-sizing: border-box; border: 0px; font-size: 0px;"><div id="google_ads_iframe_/6839/lqm.codeproject.site/General-Programming/Internet-Network/Utilities_1__container__" style="border: 0pt none; width: 160px; height: 600px;"></div></div></div>
				    </div>

                    

				    

				    

                    <div class="anchorLink gototop" id="gototop">
                        <a id="ctl00_GoToTop" href="https://www.codeproject.com/Articles/17031/A-Network-Sniffer-in-C#_articleTop">Go to top</a>
                    </div>

			    </div>
            </div>
            

        </div>
        

		
		<div class="theme1-background" style="height:2px;margin:5px 0" id="stickyStop"></div>

		<div class="site-footer">
			<div class="align-left">
				<a id="ctl00_PermaLink" href="https://www.codeproject.com/Articles/17031/A-Network-Sniffer-in-C">Permalink</a><br>
				<a id="ctl00_AdvertiseLink" href="http://developermedia.com/">Advertise </a><br>
				<a id="ctl00_PrivacyLink" href="https://www.codeproject.com/info/privacy.aspx">Privacy</a><br>
    			<a id="ctl00_CookiePolicyLink" href="https://www.codeproject.com/info/cookie.aspx">Cookies</a><br>
                <a id="ctl00_TermsOfUseLink" href="https://www.codeproject.com/info/TermsOfUse.aspx">Terms of Use</a><br>
			</div>

            <div class="align-center">
				


<div class="page-width">
    Layout: <a id="ctl00_PageWidth_FixedT" title="Fixed width layout" rel="nofollow" class=" active" href="https://www.codeproject.com/Articles/17031/A-Network-Sniffer-in-C?PageFlow=FixedWidth">fixed</a>
    |
    <a id="ctl00_PageWidth_FluidT" title="Fluid layout" rel="nofollow" href="https://www.codeproject.com/Articles/17031/A-Network-Sniffer-in-C?PageFlow=Fluid">fluid</a>
</div>


				

				

	            

                <br>
			</div>
                
			<div class="align-right">
				Article Copyright 2007 by Hitesh Sharma<br>Everything else
				Copyright © <a href="mailto:webmaster@codeproject.com">CodeProject</a>, 1999-2019 <br>
                <br>
				Web02 
				2.8.191004.1<br>
			</div>
		</div>
		

		<br clear="all">
		
			

	</div> 
	</div> 
</div>



<img id="ctl00_Audience" src="./A Network Sniffer in C# - CodeProject_files/DFPAudiencePixel" style="border-width:0px;height:1px;width:1px;">





<script type="text/javascript" src="./A Network Sniffer in C# - CodeProject_files/jquery.min.js.download"></script>
<script type="text/javascript" src="./A Network Sniffer in C# - CodeProject_files/article.min.js.download"></script>
<script type="text/javascript" src="./A Network Sniffer in C# - CodeProject_files/a.min.js.download"></script>
<script type="text/javascript" src="./A Network Sniffer in C# - CodeProject_files/MemberProfilePopup.min.js.download"></script>
<script type="text/javascript">//<![CDATA[
$(function () {
   processCodeBlocks.Initialise('#contentdiv');
});
$(function() {
	            	$('.author-wrapper .description').shorten({showChars: 400});
                });
$(function() { anchorAnimate();
$('#RHSticky').sticky($('#stickyStop'));
$('#ctl00_StickyBlock').sticky($('#stickyStop'));
});
function defrm () { /* thanks twitter */ document.write = ''; window.top.location = window.self.location;  setTimeout(function() { document.body.innerHTML = ''; }, 0);  window.self.onload = function(evt) { document.body.innerHTML = ''; }; }if (window.top !== window.self) {  try {  if (window.top.location.host) { /* will throw */ } else { defrm(); /* chrome */ }  } catch (ex) { defrm(); /* everyone else */ } }if (typeof(DemoUrl)!='undefined')   document.write(unescape('%3Cme')+'ta http'+'-equiv="re'+'fresh"                  con'+'tent="1;url='+DemoUrl+unescape('"%3CE'));
$(function(){
    $('#__EVENTVALIDATION').attr('autocomplete', 'off');
});
function Join() {
                                      document.location.href = 'https://www.codeproject.com/script/Membership/Modify.aspx';
                                      return false;
                                  }
                                  $('#joinBtn').css('visibility', 'visible');
$(function ()
                {
                    $('.oauth').click(function () {
                        $this = $(this);
                        href = $this.attr('href');
                        var myWindow = window.open(href, 'popup',
                                    'width=800,height=600,location=0,menubar=0,resizeable=0,scrollbars=0,toolbar=0');
                        myWindow.focus();
                        var timer = setInterval(function () {
                                        if (myWindow.closed) {
                                            clearInterval(timer);
                                            // window.location.reload(); // May do a POST reload, shows a warning
                                            window.location = window.location; // force a GET reload
                                        }
                                    }, 200);
                        return false;
                    });
                });
var retrievalService=function(n){var t=!1;n=n||{};var r=n.RetrievalServiceUrl||"/script/content/webservices/RetrieveContent.aspx/GetContent",u=n.RetrievalServiceRetries||3,f=n.RetrievalServiceTimeout||5e3,e=function(){t||(t=!0,$(window).on("resize scroll",i),i())},i=function(){if(typeof DMAds=="undefined"){var n=$('[data-type="ad"]');n.each(function(){var n=$(this),u=n.attr("data-format")||"",f=n.attr("data-publisher")||"",e=n.attr("data-zone")||"",t=n.attr("data-loadonview"),i=n.attr("data-noadx"),h=n.attr("data-tags")||"",c=n.find("iframe").length!==0||n.find("img").length!==0,r=n.attr("data-processed");t=typeof t=="string"&&t.toLowerCase()==="true";i=typeof i=="string"&&i.toLowerCase()==="true";r=typeof r=="string"&&r.toLowerCase()==="true";r||c||t&&!s(this)||(o(n,u,f,e,i,h),n.attr("data-processed","true"))})}},o=function(n,t,i,e,o,s){var h=new $.Deferred,c=JSON.stringify({format:t,publisherCode:i,zone:e,noAdX:o,keywords:s});$.ajax({url:r,cache:!1,type:"POST",data:c,contentType:"application/json; charset=utf-8",dataType:"json",tryCount:0,retryLimit:u,timeout:f}).done(function(t){var i=t?t.d:null;h.resolve(i); i && i.html && n.html(i.html)}).fail(function(n,t){h.reject(t)})},s=function(n){var t,f,e,o;if(!h(n))return!1;var u=!1,i=0,r=0;try{t=n.getBoundingClientRect();typeof innerWidth=="number"?(i=window.innerWidth,r=window.innerHeight):document.documentElement&&(document.documentElement.clientWidth||document.documentElement.clientHeight)?(i=document.documentElement.clientWidth,r=document.documentElement.clientHeight):document.body&&(document.body.clientWidth||document.body.clientHeight)&&(i=document.body.clientWidth,r=document.body.clientHeight);f=-200;t.top===t.bottom&&(f+=n.height*-1);e=t.top>=0&&t.top-200<=r||t.top<=0&&t.top>=f;o=i>t.left&&t.right>=0;u=e&&o}catch(s){u=!0}return u},h=function(n){var t=!1,i;return n&&n.style.position!=="fixed"&&n.offsetParent?t=!0:n&&n.style.position==="fixed"&&(i=window.getComputedStyle(n),t=i&&i.display!=="none"),t&&c()},c=function(){var t=!0,n="";return typeof document.hidden!="undefined"?n="hidden":typeof document.mozHidden!="undefined"?n="mozHidden":typeof document.msHidden!="undefined"?n="msHidden":typeof document.webkitHidden!="undefined"&&(n="webkitHidden"),n!==null&&document[n]&&(t=!1),t};return{init:e}};$(function(){var n=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("MSXML2.XMLHTTP"),t;n.onreadystatechange=function(){try{if(n.readyState==4)if(n.status==200){var t=document.createElement("script");t.type="text/javascript";t.innerHTML=n.responseText;document.getElementsByTagName("body")[0].appendChild(t)}else(new retrievalService).init()}catch(i){(new retrievalService).init()}};try{t='https://cdn2.developermedia.com/a.min.js?v=1.2';n.open("GET",t,!0);n.send()}catch(i){(new retrievalService).init()}});$(function() { 
    setTimeout(function(){ 
        $('div[data-type="ad"][data-showindicator="true"]').each(function( index ) {
            if ($(this).height() > 0) {
                $(this).prepend('<div class="small-text muted">Advertisement</div>');
            }
        });
    }, 2000);
});
var oSrchFlt = false, oSrchBox=false,srchBoxFoc=false;
$(function() {
 if(InitWatermark)InitWatermark('sb_tb', 'Search for articles, questions, tips');
 var sbar = $('#sb_tb'); 
 var sfilter = $('#SearchFilter');
 if (sbar && sfilter) {
  sfilter.removeClass('popup'); sfilter.hide(); sfilter.removeClass('open');
  sbar.blur(function() {
 if (!oSrchFlt) {sfilter.hide(); sfilter.removeClass('open');}
 srchBoxFoc=false;
 });
  sbar.focus(function() {
 oSrchFlt=false; srchBoxFoc=true;
 sfilter.show(); sfilter.addClass('open');
 });
  sbar.mouseleave(function() { oSrchBox=false; });
  sbar.mouseover(function() { oSrchBox=true; });
  sfilter.mouseleave(function() { oSrchFlt=false; if (!srchBoxFoc&&!oSrchBox) { sfilter.hide(); sfilter.removeClass('open'); }});
  sfilter.mouseover(function() { oSrchFlt=true; });
 }
});

var bookmark;
$(function() {
   bookmark = new Bookmark('[data-type="bookmark"]','https://codeproject.global.ssl.fastly.net/App_Themes/CodeProject/Img/','/script/Bookmarks/Ajax/Add.aspx?obrfgd=%5bObjectRefGuid%5d&bis=medium',false,false);
   bookmark.Initialise();
});
$('#clear-rate_ctl00_RateArticle_RSU').click(function () {    $('#ctl00_RateArticle_RSU').hide(); return false;});
function PostBack_ctl00_RateArticle_RateItemWrapper() {
  return rateItem(null, 17031,2,1,true,true,0,'LargeStars', null, 3119405);
}

                    function getVotesHistogram(objectId, objectTypeId, containerId, loadingId) {
                        if (!$('#' + containerId).attr('alreadyRequested')){
                            $.ajax({
                                url: '/script/Ratings/Ajax/Histogram.aspx?obid=' + objectId + '&obtid='+objectTypeId+'&wd=130',
                            })
                            .done(function (data) {
                                $('#' + containerId).html(data);
                                $('#' + loadingId).hide();
                            });

                            $('#' + containerId).attr('alreadyRequested', 'true');
                        }
                    }
$(function() {
  new starRating('#ctl00_RateArticle_RateItemWrapper', PostBack_ctl00_RateArticle_RateItemWrapper,'ctl00_RateArticle');
  $('#ctl00_RateArticle_VR').mouseenter(function() {     getVotesHistogram(17031,2   ,'ctl00_RateArticle_HistogramR','ctl00_RateArticle_LoadingR');
  });
})

$(function() {
  $('#ctl00_RateArticle_SubmitRateBtn').hide();
});
function ChkRtctl00_RateArticle(){}

var forumConfig_ctl00_MessageBoard = {
    objectName          : 'forumCtrl_ctl00_MessageBoard',
    messageTypeId       : 3,
    searchPrompt        : 'Search Comments',
    smoothScroll        : true,
    allowReporting      : false,
    allowRating         : false,
    allowRatingDisplay  : true,
    forumDir            : '/script/Forums/',
    staticServer        : 'https://codeproject.global.ssl.fastly.net',
    switchMsgCallback   : null,
    getVoteFormMethod   : getVoteFormHtml,
    getReportFormMethod : getReportFormHtml,
    voteHiThreshold     : 5 - 0.5,
    getRatingUrl        : '/script/Ratings/Ajax/GetRatings.aspx',
    getRatingRefKey     : 'obrs',
    reportOptions       : [
       { reportTypeId : 19, name : 'Abusive / Trolling'},
       { reportTypeId : 20, name : 'Inappropriate'},
       { reportTypeId : 5, name : 'Spam'},
    ],
};
var forumCtrl_ctl00_MessageBoard;
$(function() {
  forumCtrl_ctl00_MessageBoard = new ForumControl(forumConfig_ctl00_MessageBoard, -1);
  forumCtrl_ctl00_MessageBoard.Initialise();
});

var subscriptionConfig_ctl00_MessageBoard = {
 ParentId      : 'ctl00_MessageBoard_SubscribeDiv',
 NewId         : 'ctl00_MessageBoard_SubscribeNew',
 ReplyId       : 'ctl00_MessageBoard_SubscribeReplies',
 InstantId     : 'ctl00_MessageBoard_SubscribeInstant',
 DailyId       : 'ctl00_MessageBoard_SubscribeDaily',
 MessageTypeId : 'ctl00_MessageBoard_MessageType',
 GetInfoUrl    : '/script/Forums/WebServices/ForumSubscriptionServices.aspx/GetSubscriptions',
 UpdateInfoUrl : '/script/Forums/WebServices/ForumSubscriptionServices.aspx/UpdateSubscription',
 ForumId       : 373251,
};
var subscriptions_ctl00_MessageBoard;
$(function() {
   subscriptions_ctl00_MessageBoard = new Subscriptions(subscriptionConfig_ctl00_MessageBoard);
   subscriptions_ctl00_MessageBoard.initialise();
});


//]]>
</script>





<canvas id="cv1" width="1px" height="1px" style="position:absolute;left:0;top:0;pointer-events:none"></canvas><canvas id="cv2" width="1px" height="1px" style="position:absolute;left:0;top:0;pointer-events:none"></canvas><div id="MemberProfilePopupDiv" class="raised box" style="display: none; position: absolute;"></div><div id="MemberProfilePopupDiv" class="raised box" style="display: none; position: absolute;"></div><div id="MemberProfilePopupDiv" class="raised box" style="display: none; position: absolute;"></div><style type="text/css">.copied::after {  position: absolute;  display: inline-block;  content: 'copied'; color: #fff; background-color: #f90;  border-radius: 3px; padding:1px 3px; opacity: 0;  will-change: opacity, transform; animation: showcopied 1.5s ease; } @keyframes showcopied { 0% { opacity: 0; transform: translateX(-100%); } 70% { opacity: 1; transform: translateX(0); } 100% { opacity: 0; } } </style><style type="text/css">.copied::after {  position: absolute;  display: inline-block;  content: 'copied'; color: #fff; background-color: #f90;  border-radius: 3px; padding:1px 3px; opacity: 0;  will-change: opacity, transform; animation: showcopied 1.5s ease; } @keyframes showcopied { 0% { opacity: 0; transform: translateX(-100%); } 70% { opacity: 1; transform: translateX(0); } 100% { opacity: 0; } } </style><script type="text/javascript">var googletag;if(typeof DMAds=="undefined"){var SendDmAdUid=!1,SendSearchTermsToServer=!0,CodeProjectPublisherId="lqm.codeproject.site",EnableMutableAds=!0,EnableViewOnScroll=!0,adServer=adServer||window.location.protocol+"//ads.DeveloperMedia.com/",SearchTermUrl="https://apps.developermedia.com/Ads/PageTerms/GetTerms",AdClickUrl="https://apps.developermedia.com/Ads/PageTerms/LogClick",DownvoteUrl="https://apps.developermedia.com/Ads/AdVote/DownvoteByFingerprint",UndoDownvoteUrl="https://apps.developermedia.com/Ads/AdVote/UndoDownvote",ReportAdUrl="https://apps.developermedia.com/Ads/AdVote/ReportAd",CloseAdImageUrl="https://apps.developermedia.com/Content/images/undo.png",UndoCloseAdImageUrl="https://apps.developermedia.com/Content/images/redo.png",DmLogoImageUrl="https://apps.developermedia.com/Content/images/dm-logo-150x23.png",GlobalIdUrl="https://apps.developermedia.com/Ads/GlobalUserIdentification/",PIIViolatingUrls=["http://www.aspsnippets.com/handlers/comments.ashx","codeproject.com/script/membership/sendpassword.aspx","http://www.dailyfreecode.com/userlogin.aspx","codeproject.com/script/membership/modify.aspx","dotnetspider.com/account/login.aspx","codeproject.com/script/membership/logon.aspx"],DMAdXHelper=function(){var n=[],t={},s=!1,r=!1,v=0,f=null,y=function(n){try{var i=p(n),t=w(n),r=b(n);t.insertBefore(r,t.children[0]);n.closeAdButton=i;n.reportAdDiv=t;n.adContainer.appendChild(i);n.adContainer.parentNode.appendChild(t);n.reportButton=t.getElementsByClassName("reportButton")[0];n.reportButton.disabled=!0;n.reportButton.onclick=function(){return l(n),!1}}catch(u){console.log(u)}},p=function(n){var i=document.createElement("input");return i.type="image",i.src=t.CloseAdImageUrl,i.title="Report Ad",i.align="left",i.style.cssText="z-index:1000; position:relative; left:0px; top:-"+n.height+"px; margin-top: 0px; margin-left: 0px; display:block; font-size:0px; border: 0px; padding: 0px; height:14px; width:14px",i.onclick=n.width===125&&n.height===125?function(){return c(n),l(n),!1}:function(){return c(n),!1},i},w=function(n){var t=n.width,i=n.height,r=document.createElement("div"),u="<select class='reportReason' style='max-width:150px !important; padding: 0px !important'><option>Offensive<\/option><option>Abusive<\/option><option>Off topic<\/option><option>Don't like the Ad<\/option > <option>Wrong language<\/option><\/select > ",f="<input type='button' disabled class='reportButton' style='padding: 0px !important' value='Report'><\/input>";return t===728&&i===90?k(r,u,f):t===300&&i===250?d(r,u,f):t===160&&i===600?g(r,u,f):t===125&&i===125&&nt(r),(t===728&&i===90||t===300&&i===250||t===160&&i===600)&&tt(n,r),r},b=function(n){var i=document.createElement("input");return i.type="image",i.src=t.UndoCloseAdImageUrl,i.title="Show Ad",i.style.cssText="z-index:1000; position:relative; left:0px; top:0px; width:14px; height:14px;margin-top: 0px; margin-left: 0px; font-size:0px; display:block; padding: 0px; border: 0px",i.onclick=function(){return h(n),!1},i},k=function(n,i,r){n.innerHTML="<div class='sendReportContainer' style='padding-left: 2px; display:block; line-height:initial !important'><div style='display:inline-block; font:14px/18px \"Segoe UI\", Arial'><b>Don't like this Ad?<\/b><\/div><div class='dropzone' contenteditable='true' style='margin-left:10px; height:60px; width: 250px; background-color:lightgray; border-style:dotted; border-color:black; border-radius: 5px; border-width: 2px; text-align: center; display:inline-block; white-space:normal'>1. Hit the refresh icon to show the ad again and take a screenshot. 2. Drag and Drop or paste the screenshot here<\/div><div style='margin-left:10px; display:inline-block; font:14px/18px \"Segoe UI\", Arial;'> "+i+"&nbsp;"+r+"<\/div><\/div><div class='reportSentContainer' style='display:none; padding: 15px 20px; font:14px/18px \"Segoe UI\", Arial;'><span style='color:#999'>Thank you for the report!<\/span><\/div><a href='http://www.developermedia.com/' target='_blank'><img src='"+t.DmLogoImageUrl+"' style='max-width:100%;position:absolute; right:10px; top:10px;'><\/a>";n.style.cssText="display:none; width:728px; height:90px; z-index:100; text-align:left;border-style:solid; border-width:1px; position:relative; background-color:white;box-sizing:border-box; top:0px; left:0px"},d=function(n,i,r){n.innerHTML="<div class='sendReportContainer' style='padding: 5px 5px; display:block; line-height:initial !important'><div style='padding-bottom:5px; font:14px/18px \"Segoe UI\", Arial;'><b>Don't like this Ad?<\/b><\/div><div class='dropzone' contenteditable='true' style='height:100px; width: 290px; margin-top:20px; margin-bottom: 20px; background-color:lightgray; border-style:dotted; border-color:black; border-radius: 5px; border-width: 2px; text-align: center; box-sizing:border-box; white-space:normal'>1. Hit the refresh icon to show the ad again so you can take a screenshot <br/>2. Drag and Drop or paste the screenshot here<\/div><div style='margin-top:5px; font:14px/18px \"Segoe UI\", Arial; '> "+i+"<\/div><div style='margin-top:5px; display:block; font:14px/18px \"Segoe UI\", Arial;'>"+r+"<\/div><\/div><div class='reportSentContainer' style='display:none; padding: 15px 20px; font:14px/18px \"Segoe UI\", Arial; '><span style='color:#999;'>Thank you for the report!<\/span><\/div><a href='http://www.developermedia.com/' target='_blank'><img src='"+t.DmLogoImageUrl+"' style='max-width:100%;position:absolute; right:20px; bottom:10px;'><\/a>";n.style.cssText="display:none; width:300px; height:250px; z-index:100; text-align:left;border-style:solid; border-width:1px; position:relative; background-color:white;box-sizing:border-box; top:0px; left:0px"},g=function(n,i,r){n.innerHTML="<div class='sendReportContainer' style='padding: 20px 15px; display:block; line-height:initial !important'><div style='padding-bottom:20px; display:block; font:14px/18px \"Segoe UI\", Arial;'><b>Don't like this Ad?<\/b><\/div><div class='dropzone' contenteditable='true' style='height:180px; width: 130px; margin-top:20px; margin-bottom: 20px; background-color:lightgray; border-style:dotted; border-color:black; border-radius: 5px; border-width: 2px; text-align: center; box-sizing:border-box; white-space:normal'>1. Hit the refresh icon to show the ad again so you can take a screenshot <br/><br/>2. Drag and Drop or paste the screenshot here<\/div><div style='padding-bottom:10px; padding-top: 10px display:block; font:14px/18px \"Segoe UI\", Arial;'> "+i+"<\/div><div style='font:14px/18px \"Segoe UI\", Arial;'>"+r+"<\/div><\/div><div class='reportSentContainer' style='display:none; padding: 15px 20px; font:14px/18px \"Segoe UI\", Arial;'><span style='color:#999;'>Thank you for the report!<\/span><\/div><a href='http://www.developermedia.com/' target='_blank'><img src='"+t.DmLogoImageUrl+"' style='max-width:120px;position:absolute; right:20px; bottom:20px;'><\/a>";n.style.cssText="display:none; width:160px; height:600px; z-index:100; text-align:left;border-style:solid; border-width:1px; position:relative; background-color:white;box-sizing:border-box; top:0px; left:0px"},nt=function(n){n.innerHTML="<div class='reportSentContainer' style='padding: 5px 5px;font:14px/18px \"Segoe UI\", Arial; width: 100px; height: 100px'><span style='color:#999;'>Thank you for the report!<\/span><\/div>";n.style.cssText="display:none; width:125px; height:125px; z-index:100; text-align:left;border-style:solid; border-width:1px; position:relative; background-color:white;box-sizing:border-box; top:0px; left:0px"},tt=function(n,t){if(n&&n.adContainer){var i=t.getElementsByClassName("dropzone")[0];i.dropzoneFor=n.adContainer.id;n.dropzone=i;s&&(i.ondragenter=function(n){n.currentTarget.style.backgroundColor="yellow";n.currentTarget.innerHTML="<br/><br/>Drag and Drop the ad here"},i.ondragleave=function(n){n.currentTarget.style.backgroundColor="lightgray";u(n.currentTarget.dropzoneFor)},i.ondragover=function(n){n.stopPropagation();n.preventDefault();n.currentTarget.style.backgroundColor="yellow"},i.ondrop=function(n){n.currentTarget.style.backgroundColor="lightgreen";rt(n)});r?f?f.observe(i,{childList:!0}):i.addEventListener("DOMSubtreeModified",function(){a(i)}):i.addEventListener("paste",it,!1)}},h=function(n){n.reportAdDiv.style.display==="none"?(n.reportAdDiv.style.display="table",n.closeAdButton.style.display="none",n.adContainer.style.display="none",n.dropzone.focus()):(n.reportAdDiv.style.display="none",n.closeAdButton.style.display="block",n.adContainer.style.display="block")},e=function(n){var t=i(n),r=t.dropzone;r.style.backgroundColor="lightgreen";r.innerHTML=t.width===160&&t.height===600?"<br/> Your screenshot has been received – thanks! <br/><br/> Next step: What’s wrong with the ad":t.width===300&&t.height===250?"<br/> Your screenshot has been received – thanks! <br/><br/> Next step: What’s wrong with the ad":t.width===728&&t.height===90?"Your screenshot has been received – thanks! Next step: What’s wrong with the ad":"Ad info received. Press Report to submit"},o=function(n){var t=i(n);t&&(t.reportButton.disabled=!1)},u=function(n){var t=i(n);t&&(t.reportButton.disabled=!0)},c=function(n){h(n)},l=function(n){var r=n.reportAdDiv.getElementsByClassName("reportReason")[0],s=r&&r.options[r.selectedIndex].value||"Unspecified",u=n.reportAdDiv.getElementsByClassName("sendReportContainer")[0],f=n.reportAdDiv.getElementsByClassName("reportSentContainer")[0];u&&(u.style.display="none");f&&(f.style.display="block");try{var e=new XMLHttpRequest,i=new FormData,h=DMUserIdentityHelper&&DMUserIdentityHelper.getGlobalUserId()||0,o=null;n.fileList&&n.fileList.length>0&&(o=n.fileList[0]);e.open("POST",t.DownvoteUrl,!0);i.append("adScreenshot",o);i.append("reason",s);i.append("DmGlobalUserId",h);e.send(i)}catch(c){console.log(c)}},it=function(n){var t,h,l,s,c,a,f,v;if(!r){if(n.preventDefault(),t=[],h=!1,window.clipboardData)t=window.clipboardData.files,h=!0;else if((n.clipboardData||n.originalEvent.clipboardData)&&(l=n.clipboardData||n.originalEvent.clipboardData,s=l&&l.items||[],t=[],s&&s.length>0))for(h=!0,c=0;c<s.length;c++)a=s[c],a.kind==="file"&&(t[t.length]=a.getAsFile());f=n.currentTarget.dropzoneFor;t&&t.length>0?(v=i(f),v&&(v.fileList=t),o(f),e(f)):h?(n.currentTarget.innerHTML="<br/><br/> No files found on clipboard <br/>",u(f)):(n.currentTarget.innerHTML="<br/><br/> Paste not supported on your browser <br/>",u(f))}},rt=function(n){var f,r,t;if(n.stopPropagation(),n.preventDefault(),f=i(n.currentTarget.dropzoneFor),r=[],n.dataTransfer.files&&n.dataTransfer.files.length>0)for(t=0;t<n.dataTransfer.files.length;t++)n.dataTransfer.files[t].type&&n.dataTransfer.files[t].type.indexOf("image")>=0&&(r[r.length]=n.dataTransfer.files[t]);r.length>0?(f&&(f.fileList=r),e(n.currentTarget.dropzoneFor),o(n.currentTarget.dropzoneFor)):(n.currentTarget.style.backgroundColor="yellow",n.currentTarget.innerHTML="<br/><br/>The dropped item was not an image",u(n.currentTarget.dropzoneFor))},a=function(n){for(var t,i=0;i<n.children.length;i++)t=n.children[i],t.nodeName.toLowerCase()==="img"&&t.style.display!=="none"&&t.src&&(t.style.display="none",ut(t.src,n))},ut=function(n,t){if(n){var f=n.indexOf(","),r=n.substring(0,f),h=r.indexOf(":"),c=r.indexOf(";"),l=r.substring(h+1,c),a=n.substring(f+1),v=ot(a,l,512),u=t.dropzoneFor,s=i(u);s&&(s.fileList=[v]);e(u);o(u)}},ft=function(){var n=document.createElement("div");return"draggable"in n||"ondragstart"in n&&"ondrop"in n},et=function(){return navigator.userAgent.toLowerCase().indexOf("firefox")>-1},i=function(t){for(var i=0,r=n.length;i<r;i++)if(n[i]&&n[i].adContainer&&n[i].adContainer.id===t)return n[i];return null},ot=function(n,t,i){var e,o,r,f,s,u,h;for(t=t||"",i=i||512,e=atob(n),o=[],r=0;r<e.length;r+=i){for(f=e.slice(r,r+i),s=new Array(f.length),u=0;u<f.length;u++)s[u]=f.charCodeAt(u);h=new Uint8Array(s);o.push(h)}return new Blob(o,{type:t})};return{appendAd:function(t){n.push(t)},init:function(i,u){n=i;t=u;s=ft();r=et();r&&window.MutationObserver&&(f=new MutationObserver(function(n){n.forEach(function(n){a(n.target)})}))},showAdReportingInterface:function(n){var t=i(n);t&&y(t)},setGlobalUserId:function(n){v=n}}}(),DMUserIdentityHelper=function(){var r,t,u="dmaduid",f="dmaduid_confirm",e,o,i=[],n=0,l=function(){return SendDmAdUid?navigator.cookieEnabled!==void 0?navigator.cookieEnabled:(document.cookie="testcookie=test; max-age=10000",document.cookie.indexOf("testcookie=test")>=0):!1},a=function(){var t=document.location.hostname,n=/([^.]+\.[^.]{3,})$/i.exec(t);return n?n[1]:(n=/([^.]+\.[^.]+\.[^.]{2})$/i.exec(t),n!==null?n[1]:t)},s=function(n,t,i,r,u,f){var e="",o;e=n+"="+t;i>0&&(o=new Date,o.setTime(o.getTime()+i*864e5))&&(e+="; expires="+o.toGMTString());r&&(e+="; path="+r);u&&u.indexOf(".")!==-1&&(e+="; domain="+u);f&&(e+="; secure");document.cookie=e},h=function(n){var r=document.cookie,u=null,t,i;if(r!=="")for(t=r.split(";"),index=0;index<t.length;index++)if(i=t[index].replace(/^\s+/,""),i.substring(0,n.length+1)===n+"="){u=i.substring(n.length+1);break}return u},v=function(n){var t=document.createElement("IFRAME");return t.width=1,t.height=1,t.src=e,t.id="DMGlobalUserIdetifierIFRAME",t.name="DMGlobalUserIdetifierIFRAME",t.style.display="none",document.body.appendChild(t),t.onload=n,t},y=function(){var i,l,n,a,e;if(r)if(i=h(u),l=h(f),!l&&JSON){if(n={},n.sender=location.href,n.Id=Math.random(),a=function(){o.contentWindow.postMessage(JSON.stringify(n),GlobalIdUrl)},e=function(i){var r=null,e;try{r=JSON.parse(i.data)}catch(o){}r&&r.Id&&r.Id===n.Id&&(e=r.DmGlobalUserId,s(u,e,365,"/",t,!1),s(f,r.DmGlobalUserConfirmResponse,365,"/",t,!1),c(e))},window.addEventListener)window.addEventListener("message",e,!1);else try{window.attachEvent("message",e)}catch(y){}o=v(a)}else i&&c(i)},c=function(t){for(n=t;i.length>0;){var r=i.pop();typeof r=="function"&&r()}};return{init:function(n){e=n;r=l();t=a();y()},getGlobalUserId:function(t){return n!==0?n:t?(i.push(t),n):void 0}}}(),DMAds={SetQueryTerms:function(){function u(n){for(var i,u="",t=0;t<r.length;t++)if(i=r[t],n.indexOf(i.d)>=0){u=i.q;break}return u}function f(n,t){var r=t.toLowerCase().indexOf(n),u,i;return r<0||r+n.length>=t.length?"":(u=t.indexOf("&",r),u<0&&(u=t.length),i=t.substring(r+n.length,u),i=i.replace(/\+/gi," "),i=decodeURIComponent(i),i.replace(/\"/gi,""))}function e(n){if(n===undefined)return"";var t=n.replace(/^\s+|\s+$/gi,"");return t?(t=t.replace(/\bAND\b|\bNOT\b|^NOT\b|\bOR\b|[^A-Z0-9\+\-\#\._\s]+|\b[A-Z0-9]+:/gi," "),t.replace(/\s+/g," ")):""}var r=[{d:"www.google.",q:"q="},{d:"www.bing.com",q:"q="},{d:"search.live.com",q:"q="},{d:"search.yahoo.com",q:"p="},{d:"codeproject.com",q:"q="},{d:"msdn.microsoft.com",q:"query="},{d:"www.ask.com",q:"q="},{d:"yandex.com",q:"text="},{d:"yandex.ru",q:"text="},{d:"www.baidu.com",q:"wd="},{d:"localhost",q:"q="},{d:"mkyong.com",q:"q="},{d:"codeplex.com",q:"query="},{d:"aspsnippets.com",q:"q="},{d:"trirand.com",q:"s="}],i="",n=document.URL,t=u(n);t!==""&&(i=e(f(t,n)));i===""&&(n=document.referrer.toLocaleLowerCase(),n&&(t=u(n),t!==""&&(i=e(f(t,n)))));DMAds.PageQueryTerms=i},SetPageTagsAndPixels:function(n){var t,i,r,u;if(JSON){if(DMAds.GetTermsCalled){n&&n();return}}else return;DMAds.GetTermsCalled=!0;t=document.URL;t.indexOf("?")>0&&(t=t.substring(0,t.indexOf("?")));try{i=top.document.title}catch(f){i="FAILED TO GET DOCUMENT TITLE"}r={terms:DMAds.PageQueryTerms,title:i,url:t,publisher:DMAds.PublisherCode,DmGlobalUserId:DMUserIdentityHelper&&DMUserIdentityHelper.getGlobalUserId()||0,numberOfAdsOnPage:DMAds.Ads.length};u=function(t){if(t){var i;try{i=JSON.parse(t)}catch(r){}i&&(i.SearchTerms&&(DMAds.PageTags=i.SearchTerms),i.PublisherPageViewGuid&&(DMAds.PublisherPageViewGuid=i.PublisherPageViewGuid),i.aid&&i.aid.length&&i.aid.length>0&&DMAds.InsertAudiencePixels(i.aid))}DMAds.PublisherPageViewGuid||(DMAds.PublisherPageViewGuid=1);n&&n()};DMAds.POSTJson(SearchTermUrl,r,u,!0,500)},InsertAudiencePixels:function(n){var t,i;try{for(t=0,i=n.length;t<i;t++){var r=Math.random()+"",u=r*1e13,f=new Image;f.src="https://pubads.g.doubleclick.net/activity;dc_iu=/6839/DFPAudiencePixel;ord="+u+";dc_seg="+n[t]+"?"}}catch(e){}},GetRandom:function(n,t){for(var u,i="",r=0;r<n;r++)u=Math.floor(Math.random()*t).toString(t).toUpperCase(),i=i+u;return i},POSTJson:function(n,t,i,r,u){var f;if(JSON&&(f=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("MSXML2.XMLHTTP"),f)){var s=!1,o=function(n){s||(s=!0,i&&i(n))},e=null;r&&(e=setTimeout(function(){try{f.abort()}catch(n){}o(null)},u));f.onreadystatechange=function(){try{f.readyState===4&&(e&&clearTimeout(e),f.status===200?o(f.responseText):o(null))}catch(n){e&&clearTimeout(e);o(null)}};try{f.open("POST",n,!0);f.setRequestHeader("Content-Type","application/json");f.send(JSON.stringify(t))}catch(h){e&&clearTimeout(e);o(null)}}},SignalSuccess:function(n){window.top&&window.top.postMessage&&setTimeout(function(){window.top.postMessage(n?"DM-enabled":"DM-disabled","*")},1e3)},PageQueryTerms:null,PageTags:null,Tile:1,CurrentDocument:null,PublisherCode:null,PublisherPageViewID:0,PublisherPageViewGuid:null,CreateAdsCalled:!1,GetTermsCalled:!1,Ads:[],GPTRenderingMode:-1,ShowAd:function(n){var t=DMAds.Ads,i;if(n&&(DMAds.GPTRenderingMode!==1||!DMAds.PublisherPageViewGuid))t.push(n),DMAds.GetTermsCalled||(DMAds.PublisherCode=n.sitename,DMAds.SetPageTagsAndPixels(DMAds.ShowAd));else if(DMAds.GPTRenderingMode===1&&DMAds.PublisherPageViewGuid){while(t&&t.length>0)i=t.pop(),DMAds.RequestQueuedAd(i);n&&DMAds.RequestQueuedAd(n)}},InitGPTLibrary:function(){var n=function(){typeof googletag.pubadsReady=="undefined"?(googletag.pubads().enableSingleRequest(),googletag.pubads().disableInitialLoad(),googletag.pubads().enableAsyncRendering(),googletag.enableServices(),DMAds.GPTRenderingMode=1,googletag.pubads().addEventListener("slotRenderEnded",function(n){DMAds.OnSlotRendered(n)})):DMAds.GPTRenderingMode=2};googletag.apiReady?n():googletag.cmd.push(function(){n()})},BuildIFrameTag:function(n){var t=document.createElement("IFRAME"),i;return t.allowtransparency=!1,t.id="dm-gpt-iframe-"+n.tile,t.width=n.width,t.height=n.height,t.marginWidth=0,t.marginHeight=0,t.frameBorder=0,t.scrolling="no",i=encodeURIComponent(location.href),i.length<2048&&(t.dc_ref=i),t},BuildInlineGPTTagScript:function(n){var t="div-gpt-ad-"+n.publisher+"-"+n.zone+"-"+n.tile,i="/6839/"+n.publisher+"/"+n.zone,r="["+n.width+", "+n.height+"]",u=(n.tags||"")+","+(DMAds.PageSearchTerms||"")+","+(DMAds.PageQueryTerms||""),f="<div id='"+t+"'>     <script type='text/javascript'>         googletag.cmd.push(function() {             googletag.defineSlot('"+i+"', "+r+",'"+t+"')                 .addService(googletag.pubads())                 .setTargeting('kw', '"+u+"');             googletag.enableServices();             googletag.display('"+t+"');         });     <\/script> <\/div>";return"<script type='text/javascript'> var googletag = googletag || {}; googletag.cmd = googletag.cmd || []; (function() {     var gads = document.createElement('script');     gads.async = true;     gads.type = 'text/javascript';     var useSSL = 'https:' == document.location.protocol;     gads.src = (useSSL ? 'https:' : 'http:') + '//www.googletagservices.com/tag/js/gpt.js';     var node =document.getElementsByTagName('script')[0];     node.parentNode.insertBefore(gads, node); })(); <\/script>"+f},BuildGPTTag:function(n){var t=document.createElement("DIV"),i;t.style.height=n.height+"px";t.style.width=n.width+"px";t.style.boxSizing="border-box";t.style.border="0px";t.style.fontSize="0px";i="div-gpt-ad-"+n.publisher+"/"+n.zone+"-"+n.tile;t.id=i;t.adIndex=n.index;n.theAdDiv.appendChild(t);n.adContainer=t;googletag.cmd.push(function(){var u="/6839/"+n.publisher+"/"+n.zone,r=(n.tags||"")+","+(DMAds.PageSearchTerms||"")+","+(DMAds.PageQueryTerms||""),t;r=DMAds.EscapeSpecialCharacters({tags:r});t=googletag.defineSlot(u,[n.width,n.height],i).setTargeting("kw",r);n.articleid&&n.articleid>0&&t.setTargeting("articleid",n.articleid);t.addService(googletag.pubads());n.collapse_empty&&t.setCollapseEmptyDiv(!0,!0);googletag.display(i);googletag.pubads().refresh([t],{changeCorrelator:!1})})},RequestQueuedAd:function(n){googletag.cmd.push(function(){var r="/6839/"+n.sitename+"/"+n.zonename,i=(n.tags||"")+","+(DMAds.PageSearchTerms||""),t;i=DMAds.EscapeSpecialCharacters({tags:i});t=googletag.defineSlot(r,[n.width,n.height],n.targetDivId).setTargeting("kw",i);n.articleid&&n.articleid>0&&t.setTargeting("articleid",n.articleid);t.addService(googletag.pubads());n.collapse_empty&&t.setCollapseEmptyDiv(!0,!0);googletag.display(n.targetDivId);googletag.pubads().refresh([t],{changeCorrelator:!1})})},BuildInlineGPTTag:function(n){var t=DMAds.BuildIFrameTag(n),i;n.theAdDiv.appendChild(t);i=t.contentDocument||t.contentWindow.document||t.contentWindow.window.document;i.write(DMAds.BuildInlineGPTTagScript(n))},EscapeSpecialCharacters:function(n){var t=n.tags,i;t=t.replace(/\+/gi,"{plus}");t=t.replace(/\#/gi,"{sharp}");t=t.replace(/\./gi,"{dot}");t=t.replace(/[\#\*\.\(\)\+\<\>\[\]]/gi,"");for(var r=t.split(","),u=[];r.length>0;)i=r.shift(),/[^\u0020-\u007f]/.test(i)||u.push(i);return u.join(",")},GetArticleId:function(n){var t=0,i,r;if(n&&n===CodeProjectPublisherId)try{i="Articles";r=window.location.href.indexOf(i);r>=0&&(t=window.location.href.substring(r+i.length+1),t=t.substring(0,t.indexOf("/")),t=parseInt(t),isNaN(t)&&(t=0))}catch(u){t=0}return t},IsPagePIICompliant:function(){var t=!0,i,n,r;try{for(i=window.location.href.toLowerCase(),n=0,r=PIIViolatingUrls.length;n<r&&t;n++)t=!(i.indexOf(PIIViolatingUrls[n])>=0)}catch(u){}return t},OnSlotRendered:function(n){if(window.location.href&&window.location.href.includes("show_creative_id=1")&&n&&n.creativeId&&console.log(n.creativeId),EnableMutableAds&&n&&!n.isEmpty&&(!n.lineItemId||n.lineItemId&&n.lineItemId===0))DMAdXHelper.showAdReportingInterface(n.slot.getSlotElementId());else if(n&&n.isEmpty){var t=document.getElementById(n.slot.getSlotElementId());t.style.width="0px";t.style.height="0px";t.style.display="none"}DMAds.SignalSuccess(!0)},DetermineTagSize:function(n){if(n.format){var t=n.format.split("x");t.length===2&&(n.width=parseInt(t[0]),n.height=parseInt(t[1]))}},AdjustForCodePlex:function(n){n.site&&(n.publisher="lqm.codeplex.site",n.zone=n.charity?"donated2charity":n.site.toLowerCase())},GetElementsByAttr:function(n,t,i,r){var o=[],u,e;i||(i=document);r||(r="*");var f=i.getElementsByTagName(r),s=f.length,h=new RegExp("(^|\\s)"+t+"(\\s|$)");for(u=0,e=0;u<s;u++)h.test(f[u].getAttribute(n))&&(o[e]=f[u],e++);return o},GetElementsByClass:function(n,t,i){var e=[],r,f;t||(t=document);i||(i="*");var u=t.getElementsByTagName(i),o=u.length,s=new RegExp("(^|\\s)"+n+"(\\s|$)");for(r=0,f=0;r<o;r++)s.test(u[r].className)&&(e[f]=u[r],f++);return e},SetAdRequestData:function(){var n=DMAds.GetElementsByAttr("data-type","ad",document,"div"),t;for((n===null||n.length<=0)&&(n=DMAds.GetElementsByClass("lqm_ad",document,"div")),t=0;t<n.length;t++)DMAds.Ads[DMAds.Ads.length]=DMAds.GetDivRequestData(n[t],t)},GetDivRequestData:function(n,t){for(var r,f,u,o=n.attributes,s=o.length,i={},e=0;e<s;e++)r=o.item(e),r.nodeName.indexOf("lqm_")===0&&(f=r.nodeName.slice(4),i[f]=r.value||r.nodeValue),r.nodeName.indexOf("data-")===0&&(f=r.nodeName.slice(5),i[f]=r.value||r.nodeValue);return u={height:0,width:0,publisher:i.publisher,zone:i.zone||"ros",site:i.site,tags:i.tags,sitename:undefined,zonename:undefined,target:"_blank",format:i.format,index:t,tile:t+1,type:i.type,noadx:i.noadx,collapse_empty:i.collapse_empty,displayOverride:i.display||i.loadOnView,sticky:i.sticky,charity:i.charity,theAdDiv:n},u.tags&&(u.tags=decodeURIComponent(u.tags)),DMAds.DetermineTagSize(u),DMAds.AdjustForCodePlex(u),u.articleid=DMAds.GetArticleId(u.publisher),u}};if(typeof DMAds.CreateAds!="function"&&(DMAds.CreateAds=function(n){var y=this;this.PageRandomNumber=this.GetRandom(32,16);var e=function(n){var t=DMAds.Ads[n];t.rendered=!0;DMAds.GPTRenderingMode===1?DMAds.BuildGPTTag(t):DMAds.BuildInlineGPTTag(t)},l=function(n){var e=DMAds.Ads[n],h=e.theAdDiv,u=!1,i=0,r=0,t,f,o,s;try{t=h.getBoundingClientRect();typeof innerWidth=="number"?(i=window.innerWidth,r=window.innerHeight):document.documentElement&&(document.documentElement.clientWidth||document.documentElement.clientHeight)?(i=document.documentElement.clientWidth,r=document.documentElement.clientHeight):document.body&&(document.body.clientWidth||document.body.clientHeight)&&(i=document.body.clientWidth,r=document.body.clientHeight);f=-200;t.top===t.bottom&&(f+=e.height*-1);o=t.top>=0&&t.top-200<=r||t.top<=0&&t.top>=f;s=i>t.left&&t.right>=0;u=o&&s}catch(c){u=!0}return u},t=function(){for(var t,i=0,n=0;n<DMAds.Ads.length;n++)t=DMAds.Ads[n],!t.rendered&&l(n)&&u(n)&&e(n),t.rendered&&(i++,t.sticky&&!t.stickySettings&&(t.stickySettings=s(t)),c(n));i===DMAds.Ads.length&&clearInterval(f)},o=function(){var n=function(){for(var c,i,r,o,s=EnableViewOnScroll,n=0;n<DMAds.Ads.length;n++)c=DMAds.Ads[n],c.rendered=!1,i=c.displayOverride,i==="onscroll"||i==="true"?s=!0:(i==="always"||i==="false")&&(s=!1),!s&&u(n)&&e(n);if(t(),window.addEventListener)window.addEventListener("resize",function(){t();h()},!1),window.addEventListener("scroll",t,!1);else try{window.attachEvent("onresize",function(){t();h()});window.attachEvent("onscroll",t)}catch(l){}for(a(),r=!1,o=0;o<DMAds.Ads.length&&!r;o++)r=!u(o);r&&(f=setInterval(t,100))};DMAds.GPTRenderingMode===-1?googletag.cmd.push(function(){n()}):n()},a=function(){var n=null;typeof document.hidden!="undefined"?n="visibilitychange":typeof document.mozHidden!="undefined"?n="mozvisibilitychange":typeof document.msHidden!="undefined"?n="msvisibilitychange":typeof document.webkitHidden!="undefined"&&(n="webkitvisibilitychange");n&&document.addEventListener(n,t,!1)},s=function(n){var u=null,i,t;return n.adContainer&&(i=r(n.adContainer),t={},t.isStickyRequired=n.sticky&&n.sticky==="top",t.absoluteTop=i.y,t.absoluteLeft=i.x,t.absoluteTop!==-1&&(t.originalPosition=n.theAdDiv.style.position,u=t)),u},h=function(){for(i=0;i<DMAds.Ads.length;i++){var n=DMAds.Ads[i];n.stickySettings&&n.adContainer&&(n.adContainer.style.position=n.stickySettings.originalPosition,n.stickySettings=s(n),c(i))}},c=function(n){var t=DMAds.Ads[n].adContainer,i=DMAds.Ads[n].stickySettings,e=DMAds.Ads[n].theAdDiv,u,h,s,c,f,o;i&&i.isStickyRequired&&t.getBoundingClientRect&&document.getElementsByClassName&&(u=document.getElementsByClassName("sticky-stop")[0],u&&(h=r(u),s=u.getBoundingClientRect()),c=r(t),f=t.getBoundingClientRect(),u&&c.y+f.height+Math.abs(f.top)>h.y&&s.top<f.height?o=s.top-f.height+"px":window.pageYOffset+10>=i.absoluteTop&&(o="10px"),o?(t.style.position="fixed",t.style.top=o,t.style.left=i.absoluteLeft-window.pageXOffset+"px",e.clientHeight===0&&(e.style.height=t.clientHeight+"px"),e.clientWidth===0&&(e.style.width=t.clientWidth+"px")):t.style.position=i.originalPosition)},r=function(n){var t={};if(t.x=-1,t.y=-1,n.getBoundingClientRect){var r=n.getBoundingClientRect(),i=document.documentElement,u=window.pageYOffset||i.scrollTop||document.body.scrollTop||0,f=window.pageXOffset||i.scrollLeft||document.body.scrollLeft||0,e=i.clientTop||document.body.clientTop||0,o=i.clientLeft||document.body.clientLeft||0;t.y=r.top+u-e;t.x=r.left+f-o}return t},u=function(n){var t=DMAds.Ads[n].theAdDiv,i=!1,r;return t&&t.style.position!=="fixed"&&t.offsetParent?i=!0:t&&t.style.position==="fixed"&&(r=window.getComputedStyle(t),i=r&&r.display!=="none"),i&&v()},v=function(){var t=!0,n="";return typeof document.hidden!="undefined"?n="hidden":typeof document.mozHidden!="undefined"?n="mozHidden":typeof document.msHidden!="undefined"?n="msHidden":typeof document.webkitHidden!="undefined"&&(n="webkitHidden"),n!==null&&document[n]&&(t=!1),t},f=f||null;n||DMAds.CreateAdsCalled?n&&(DMAds.Ads[DMAds.Ads.length]=DMAds.GetDivRequestData(n,DMAds.Ads.length-1),DMAds.PublisherCode=DMAds.Ads[0].publisher,DMAds.SetPageTagsAndPixels(o)):(DMAds.CreateAdsCalled=!0,DMAds.SetAdRequestData(),DMAds.Ads.length>0&&(DMAds.PublisherCode=DMAds.Ads[0].publisher,DMAds.SetPageTagsAndPixels(o)))}),!window.googletag&&DMAds.IsPagePIICompliant()&&(googletag=googletag||{},googletag.cmd=googletag.cmd||[],function(){var i="https:"===document.location.protocol,n=document.createElement("script"),t;n.async=!0;n.type="text/javascript";n.src=(i?"https:":"http:")+"//www.googletagservices.com/tag/js/gpt.js";t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(n,t)}()),DMAds.IsPagePIICompliant())if(DMAds.InitGPTLibrary(),DMAds.SetQueryTerms(),DMAdXHelper.init(DMAds.Ads,{DownvoteUrl:DownvoteUrl,UndoDownvoteUrl:UndoDownvoteUrl,ReportAdUrl:ReportAdUrl,CloseAdImageUrl:CloseAdImageUrl,UndoCloseAdImageUrl:UndoCloseAdImageUrl,DmLogoImageUrl:DmLogoImageUrl}),DMUserIdentityHelper.init(GlobalIdUrl),document.readyState==="complete")DMAds.CreateAds();else if(window.addEventListener)window.addEventListener("DOMContentLoaded",function(){DMAds.CreateAds()},!1),window.addEventListener("load",function(){DMAds.CreateAds()},!1);else try{document.attachEvent("onreadystatechange",function(){DMAds.CreateAds()});window.attachEvent("onload",function(){DMAds.CreateAds()})}catch(e){DMAds.CreateAds()}}</script></body></html>